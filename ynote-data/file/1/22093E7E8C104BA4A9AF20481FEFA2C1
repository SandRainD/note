<?xml version="1.0" encoding="UTF-8" standalone="no"?><note xmlns="http://note.youdao.com" file-version="0" schema-version="1.0.3"><head/><body><heading compat="true" level="a"><coId>2479-1623562090499</coId><text>自动填充</text><inline-styles><bold><from>0</from><to>4</to><value>true</value></bold><font-size><from>0</from><to>4</to><value>32</value></font-size><color><from>0</from><to>4</to><value>#333333</value></color></inline-styles><styles/></heading><para><coId>4712-1623562296362</coId><text>创建时间、修改时间！这些个操作一遍都是自动化完成的，我们不希望手动更新！</text><inline-styles><font-size><from>0</from><to>36</to><value>13</value></font-size><color><from>0</from><to>36</to><value>#333333</value></color></inline-styles><styles/></para><para><coId>3929-1623562296362</coId><text>阿里巴巴开发手册：所有的数据库表：gmt_create、gmt_modifified几乎所有的表都要配置上！而且需</text><inline-styles><font-size><from>0</from><to>57</to><value>13</value></font-size><color><from>0</from><to>57</to><value>#333333</value></color></inline-styles><styles/></para><para><coId>8954-1623562296362</coId><text>要自动化！</text><inline-styles><font-size><from>0</from><to>5</to><value>13</value></font-size><color><from>0</from><to>5</to><value>#333333</value></color></inline-styles><styles/></para><heading compat="true" level="2"><coId>7472-1623562296362</coId><text>方式一：数据库级别（工作中不允许你修改数据库）</text><inline-styles><bold><from>0</from><to>23</to><value>true</value></bold><font-size><from>0</from><to>23</to><value>20</value></font-size><color><from>0</from><to>23</to><value>#777777</value></color></inline-styles><styles/></heading><para><coId>8730-1623562296362</coId><text>1、在表中新增字段 create_time, update_time</text><inline-styles><font-size><from>0</from><to>34</to><value>13</value></font-size><color><from>0</from><to>34</to><value>#333333</value></color></inline-styles><styles/></para><image><coId>8170-1623562472419</coId><source>https://note.youdao.com/yws/res/13911/C52DC620015F4FCEA78BFC2E118DD732</source><text/><styles><width>620</width><height>121</height></styles></image><para><coId>5092-1623562310384</coId><text>2、再次测试插入方法，我们需要先把实体类同步！</text><inline-styles><font-size><from>0</from><to>23</to><value>13</value></font-size><color><from>0</from><to>23</to><value>#333333</value></color></inline-styles><styles/></para><code><coId>5552-1623562340846</coId><text>private Date createTime;
private Date updateTime;
</text><inline-styles/><styles/><language>java</language><theme>tomorrow</theme></code><para><coId>1940-1623562330637</coId><text>3、再次更新查看结果即可</text><inline-styles><font-size><from>0</from><to>12</to><value>13</value></font-size><color><from>0</from><to>12</to><value>#333333</value></color></inline-styles><styles/></para><heading compat="true" level="2"><coId>7310-1623562330637</coId><text>方式二：代码级别</text><inline-styles><bold><from>0</from><to>8</to><value>true</value></bold><font-size><from>0</from><to>8</to><value>20</value></font-size><color><from>0</from><to>8</to><value>#777777</value></color></inline-styles><styles/></heading><para><coId>4588-1623562330637</coId><text>1、删除数据库的默认值、更新操作！</text><inline-styles><font-size><from>0</from><to>17</to><value>13</value></font-size><color><from>0</from><to>17</to><value>#333333</value></color></inline-styles><styles/></para><image><coId>4947-1623562493223</coId><source>https://note.youdao.com/yws/res/13915/8FE2532B9B9140AD9CA5F8FF62013C82</source><text/><styles><width>620</width><height>90</height></styles></image><para><coId>7166-1623562330637</coId><text>2、实体类字段属性上需要增加注解</text><inline-styles><font-size><from>0</from><to>16</to><value>13</value></font-size><color><from>0</from><to>16</to><value>#333333</value></color></inline-styles><styles/></para><code><coId>9872-1623562687710</coId><text>// 字段添加填充内容
@TableField(fill = FieldFill.INSERT)
private Date createTime;
@TableField(fill = FieldFill.INSERT_UPDATE)
private Date updateTime;
</text><inline-styles/><styles/><language>java</language><theme>tomorrow</theme></code><para><coId>1161-1623562330637</coId><text>3、编写处理器来处理这个注解即可！</text><inline-styles><font-size><from>0</from><to>17</to><value>13</value></font-size><color><from>0</from><to>17</to><value>#333333</value></color></inline-styles><styles/></para><code><coId>7690-1623562708070</coId><text>@Slf4j
@Component // 一定不要忘记把处理器加到IOC容器中！
public class MyMetaObjectHandler implements MetaObjectHandler {
// 插入时的填充策略
@Override
public void insertFill(MetaObject metaObject) {
log.info("start insert fill.....");
// setFieldValByName(String fieldName, Object fieldVal, MetaObject
metaObject
this.setFieldValByName("createTime",new Date(),metaObject);
this.setFieldValByName("updateTime",new Date(),metaObject);
}
// 更新时的填充策略
@Override
public void updateFill(MetaObject metaObject) {
log.info("start update fill.....");
this.setFieldValByName("updateTime",new Date(),metaObject);
}
}
</text><inline-styles/><styles/><language>java</language><theme>tomorrow</theme></code><para><coId>8750-1623562708070</coId><text/><inline-styles/><styles/></para><para><coId>2139-1623562710332</coId><text>4、测试插入</text><inline-styles><font-size><from>0</from><to>6</to><value>13</value></font-size><color><from>0</from><to>6</to><value>#333333</value></color></inline-styles><styles/></para><para><coId>7436-1623562768956</coId><text>5、测试更新、观察时间即可！</text><inline-styles><font-size><from>0</from><to>14</to><value>13</value></font-size><color><from>0</from><to>14</to><value>#333333</value></color></inline-styles><styles/></para></body></note>