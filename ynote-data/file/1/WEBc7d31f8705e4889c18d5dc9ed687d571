{"2":"1","3":"Ju9C-1621846617594","4":{"version":1,"incompatibleVersion":0,"fv":"0"},"5":[{"3":"3060-1621846615933","5":[{"2":"2","3":"p5PQ-1621846617594","7":[{"8":"在数据库调优中，我们的目标就是响应时间更快，吞吐量更大。利用宏观的监控工具和微观的日志分析可以帮我们快速找到调优的思路和方式。"}]}]},{"3":"wrzu-1658649192757","4":{"l":"h3"},"5":[{"2":"2","3":"pMv7-1658649192756","7":[{"8":"数据库服务器的优化步骤","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"mDLy-1658649193267","5":[{"2":"2","3":"feBJ-1658649193266","7":[{"8":"整个流程划分成了观察(Show status）和行动(Action）两个部分。字母S的部分代表观察（会使用相应的分析工具)，字母A代表的部分是行动（对应分析可以采取的行动)。"}]}]},{"3":"NHhj-1658650475448","4":{"version":1,"cropData":{"left":0,"top":0,"scale":1,"w":572,"h":781},"u":"https://note.youdao.com/yws/res/23974/WEBRESOURCE2e073a59dd4d122416a2e0c338cb2a99","w":572,"h":809},"6":"im"},{"3":"fvb4-1658650522355","4":{"version":1,"u":"https://note.youdao.com/yws/res/23971/WEBRESOURCE59067300956acedad3f99c96ed696196","w":572,"h":154},"6":"im"},{"3":"40xb-1658652957438","4":{"version":1,"u":"https://note.youdao.com/yws/res/23972/WEBRESOURCE50448739ed8410965c9e6a2c15460545","w":442,"h":265},"6":"im"},{"3":"VFzv-1658652957421","4":{"l":"h3"},"5":[{"2":"2","3":"R5Xv-1658652957422","7":[{"8":"查看系统性能参数","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"jiAR-1658649194045","5":[{"2":"2","3":"wAyi-1658649194043","7":[{"8":"在MySQL中，可以使用 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"SHOW STATUS ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"语句查询一些MySQL数据库服务器的 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"性能参数 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"、 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"执行频率 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"o2ou-1658649194143","5":[{"2":"2","3":"VT8u-1658649194142","7":[{"8":"SHOW STATUS语句语法如下：","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"pUOj-1658653008420","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"JEze-1658653008419","5":[{"2":"2","3":"sQJp-1658649194251","7":[{"8":"SHOW [GLOBAL|SESSION] STATUS LIKE \u0027参数\u0027;"}]}],"6":"cl"}],"6":"cd"},{"3":"E43t-1658649194348","4":{"li":"baq0-1658653137920","lt":"unordered","ll":1},"5":[{"2":"2","3":"19Bx-1658649194347","7":[{"8":"Connections：连接MySQL服务器的次数。 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"rPHK-1658653085419","4":{"li":"baq0-1658653137920","lt":"unordered","ll":1},"5":[{"2":"2","3":"JmpJ-1658653085416","7":[{"8":"Uptime：MySQL服务器的上线时间。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"Gcxr-1658653089401","4":{"li":"baq0-1658653137920","lt":"unordered","ll":1},"5":[{"2":"2","3":"RdFx-1658653089399","7":[{"8":"Slow_queries：慢查询的次数。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"0zI5-1658653093327","4":{"li":"baq0-1658653137920","lt":"unordered","ll":1},"5":[{"2":"2","3":"d1jG-1658653093325","7":[{"8":"Innodb_rows_read：Select查询返回的行数 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"Od7K-1658653080127","4":{"li":"baq0-1658653137920","lt":"unordered","ll":1},"5":[{"2":"2","3":"VXox-1658653080126","7":[{"8":"Innodb_rows_inserted：执行INSERT操作插入的行数 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"QKPx-1658653102827","4":{"li":"baq0-1658653137920","lt":"unordered","ll":1},"5":[{"2":"2","3":"B72J-1658653102825","7":[{"8":"Innodb_rows_updated：执行UPDATE操作更新的行数","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"HPM5-1658653108906","4":{"li":"baq0-1658653137920","lt":"unordered","ll":1},"5":[{"2":"2","3":"Gwd2-1658653108904","7":[{"8":"Innodb_rows_deleted：执行DELETE操作删除的行数","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"VJNj-1658653113252","4":{"li":"baq0-1658653137920","lt":"unordered","ll":1},"5":[{"2":"2","3":"EXRa-1658653113250","7":[{"8":"Com_select：查询操作的次数。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"qPP2-1658653080133","4":{"li":"baq0-1658653137920","lt":"unordered","ll":1},"5":[{"2":"2","3":"LQ7O-1658653080131","7":[{"8":"Com_insert：插入操作的次数。对于批量插入的 INSERT 操作，只累加一次。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"jZx0-1658653117660","4":{"li":"baq0-1658653137920","lt":"unordered","ll":1},"5":[{"2":"2","3":"jxMo-1658653117658","7":[{"8":"Com_update：更新操作的次数。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"WkmW-1658653122751","4":{"li":"baq0-1658653137920","lt":"unordered","ll":1},"5":[{"2":"2","3":"K5LQ-1658653122749","7":[{"8":"Com_delete：删除操作的次数。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"a2QR-1658649194443","4":{"l":"h3"},"5":[{"2":"2","3":"w36U-1658649194441","7":[{"8":"统计","9":[{"2":"b"},{"0":"#34495e","2":"c"}]},{"8":"SQL","9":[{"0":"#34495e","2":"c"}]},{"8":"的查询成本：","9":[{"2":"b"},{"0":"#34495e","2":"c"}]},{"8":"last_query_cost","9":[{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"A1yl-1658649194541","5":[{"2":"2","3":"q4Q5-1658649194539","7":[{"8":"一条sQL查询语句在执行前需要确定查询执行计划，如果存在多种执行计划的话，MySQL会计算每个执行计划所需要的成本，从中选择成本最小的一个作为最终执行的执行计划。"}]}]},{"3":"TsNQ-1658653477497","4":{"version":1},"5":[{"2":"2","3":"N4BN-1658653477496","7":[{"8":"如果我们想要查看某条sQL语句的查询成本，可以在执行完这条SQL语句之后，通过查看当前会话中的"}]}]},{"3":"57kS-1658653477499","4":{"version":1},"5":[{"2":"2","3":"pyXL-1658653477498","7":[{"8":"last_query_cost变量值来得到当前查询的成本。它通常也是我们评价一个查询的执行效率的一个常用指标。这个查询成本对应的是SQL语句所需要读取的页的数量。"}]}]},{"3":"imLg-1658653593183","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"AZha-1658653593181","5":[{"2":"2","3":"hEN4-1658649194654","7":[{"8":"SHOW STATUS LIKE \u0027last_query_cost\u0027; #1代表只需要一个数据页"}]}],"6":"cl"}],"6":"cd"},{"3":"W1CE-1658649194748","5":[{"2":"2","3":"oLlv-1658649194747","7":[{"8":"使用场景:它对于比较开销是非常有用的，特别是我们有好几种查询方式可选的时候。"}]}]},{"3":"a12O-1658649194843","5":[{"2":"2","3":"2KZO-1658649194842","7":[{"8":"SQL查询是一个动态的过程，从页加载的角度来看，我们可以得到以下两点结论:"}]}]},{"3":"FZG7-1658653709743","4":{"li":"rp95-1658653727200","lt":"ordered","ll":1},"5":[{"2":"2","3":"hcxP-1658653709742","7":[{"8":"位置决定效率。如果页就在数据库缓冲池中,那么效率是最高的，否则还需要从内存或者磁盘中进行读取，当然针对单个页的读取来说，如果页存在于内存中，会比在磁盘中读取效率高很多。"}]}],"6":"l"},{"3":"2oki-1658653709747","4":{"li":"rp95-1658653727200","lt":"ordered","ll":1},"5":[{"2":"2","3":"rEZU-1658653709746","7":[{"8":"批量决定效率。如果我们从磁盘中对单一页进行随机读，那么效率是很低的（差不多10ms，而采用顺序读取的方式，批量对页进行读取，平均一页的读取效率就会提升很多，甚至要快于单个页面在内存中的随机读取。"}]}],"6":"l"},{"3":"Orii-1658653709753","4":{"version":1},"5":[{"2":"2","3":"dTfw-1658653709752","7":[{"8":"所以说，遇到I/O并不用担心，方法找对了，效率还是很高的。我们首先要考虑数据存放的位置，如果是经常使用的数据就要尽量放到缓冲池中，其次我们可以充分利用磁盘的吞吐能力，一次性批量读取数据，这样单个页的读取效率也就得到了提升。"}]}]},{"3":"MGht-1658649194926","4":{"l":"h1"},"5":[{"2":"2","3":"3VMf-1658649194925","7":[{"8":"定位执行慢的 ","9":[{"2":"b"},{"0":"#34495e","2":"c"}]},{"8":"SQL","9":[{"0":"#34495e","2":"c"}]},{"8":"：慢查询日志","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"Pzjr-1658654090602","4":{"version":1},"5":[{"2":"2","3":"3dlx-1658654090603","7":[{"8":"MySQL的慢查询日志，用来记录在MySQL中响应时间超过阀值的语句，具体指运行时间超过long_query_time值的sQL，则会被记录到慢查询日志中。long_query_time的默认值为10，意思是运行10秒以上(不含10秒)的语句，认为是超出了我们的最大忍耐时间值。"}]}]},{"3":"sEFJ-1658654106416","4":{"version":1},"5":[{"2":"2","3":"IUxP-1658654106415","7":[{"8":"它的主要作用是，帮助我们发现那些执行时间特别长的sQL查询，并且有针对性地进行优化从而提高系统的整体效率。当我们的数据库服务器发生阻塞、运行变慢的时候，检查一下慢查询日志，找到那些慢查询，对解决问题很有帮助。比如一条sql执行超过5秒钟，我们就算慢sQL，希望能收集超过5秒的sql，结合explain进行全面分析。"}]}]},{"3":"GdzD-1658654106422","4":{"version":1},"5":[{"2":"2","3":"38Yq-1658654106421","7":[{"8":"默认情况下，MySQL数据库没有开启慢查询日志，需要我们手动来设置这个参数。如果不是调优需要的话，一般不建议启动该参数，因为开启慢查询日志会或多或少带来一定的性能影响。"}]}]},{"3":"vVBy-1658654106424","4":{"version":1},"5":[{"2":"2","3":"nVk1-1658654106423","7":[{"8":"慢查询日志支持将日志记录写入文件。"}]}]},{"3":"fDdO-1658649195021","4":{"l":"h3"},"5":[{"2":"2","3":"ZPWt-1658649195020","7":[{"8":"开启慢查询日志参数","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"L2Pv-1658649195119","5":[{"2":"2","3":"HrlD-1658649195117","7":[{"8":"1. ","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"开启","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"slow_query_log","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"u3tD-1658654082229","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"mYGD-1658654082227","5":[{"2":"2","3":"JXuG-1658649195212","7":[{"8":"mysql \u003e set global slow_query_log\u003d\u0027ON\u0027; "}]}],"6":"cl"},{"3":"iCKw-1658722743619","5":[{"2":"2","3":"Batz-1658722743617","7":[{"8":"show variables like \u0027%slow_query_log%\u0027;#查看是否开启以及慢查询日志文件的位置"}]}],"6":"cl"}],"6":"cd"},{"3":"VM3w-1658649195327","5":[{"2":"2","3":"IJ3I-1658649195325","7":[{"8":"2. ","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"修改","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"long_query_time","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"阈值","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"iiQM-1658722779543","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"JXgd-1658722779542","5":[{"2":"2","3":"CPTa-1658649195418","7":[{"8":"mysql \u003e show variables like \u0027%long_query_time%\u0027; #查看"}]}],"6":"cl"},{"3":"gVGo-1658722789147","5":[{"2":"2","3":"VThA-1658722789145","7":[{"8":"#测试发现：设置global的方式对当前session的long_query_time失效。对新连接的客户端有效。所以可以一并 "}]}],"6":"cl"},{"3":"hOrI-1658722811809","5":[{"2":"2","3":"BOZ5-1658722811808","7":[{"8":"执行下述语句 "}]}],"6":"cl"},{"3":"CPIH-1658722811811","5":[{"2":"2","3":"e3OM-1658722811810","7":[{"8":"mysql \u003e set global long_query_time \u003d 1; "}]}],"6":"cl"},{"3":"orCT-1658722811813","5":[{"2":"2","3":"dIAv-1658722811812","7":[{"8":"mysql\u003e show global variables like \u0027%long_query_time%\u0027; "}]}],"6":"cl"},{"3":"Q9gS-1658722811815","5":[{"2":"2","3":"dG3z-1658722811814","7":[{"8":"mysql\u003e set long_query_time\u003d1; "}]}],"6":"cl"},{"3":"7mD7-1658722811817","5":[{"2":"2","3":"9PGe-1658722811816","7":[{"8":"mysql\u003e show variables like \u0027%long_query_time%\u0027;"}]}],"6":"cl"}],"6":"cd"},{"3":"zIAx-1658649195517","5":[{"2":"2","3":"JXX2-1658649195516","7":[{"8":"补充：配置文件中一并设置参数","9":[{"0":"#000000","2":"c"}]}]}]},{"3":"CcKi-1658722926773","4":{"version":1,"u":"https://note.youdao.com/yws/res/23973/WEBRESOURCEb40d4e9bd1cd346ea1bda05a97d7a3cc","w":572,"h":183},"6":"im"},{"3":"M7dF-1658649198037","4":{"l":"h3"},"5":[{"2":"2","3":"yyNh-1658649198036","7":[{"8":"查看慢查询数目","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"qcAi-1658722968831","4":{"version":1},"5":[{"2":"2","3":"ScUV-1658722968832","7":[{"8":"查询当前系统中有多少条慢查询记录"}]}]},{"3":"4tYh-1658722963003","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"l94o-1658722963002","5":[{"2":"2","3":"FPmd-1658649198552","7":[{"8":"SHOW GLOBAL STATUS LIKE \u0027%Slow_queries%\u0027; "}]}],"6":"cl"}],"6":"cd"},{"3":"fftc-1658649198651","4":{"l":"h3"},"5":[{"2":"2","3":"AnjG-1658649198650","7":[{"8":"案例演示","9":[{"0":"#000000","2":"c"}]}]}],"6":"h"},{"3":"CkNZ-1658723022096","4":{"version":1,"sr":"https://note.youdao.com/yws/res/22608/WEBRESOURCETHUMB672312d192674df590c97d30ae2703c5","re":"https://note.youdao.com/yws/res/22607/WEBRESOURCEa07196e1edf66703e2ffd93cf61213a0","fn":"第09章_性能分析工具的使用.pdf","fl":1936890},"6":"a"},{"3":"cjzc-1658723419840","4":{"version":1,"u":"https://note.youdao.com/yws/res/23977/WEBRESOURCE5fc3c2caeea06d931b5da4f77ab0268d","w":572,"h":309},"6":"im"},{"3":"Wi02-1658649198844","4":{"l":"h3"},"5":[{"2":"2","3":"Hfso-1658649198842","7":[{"8":"慢查询日志分析工具：","9":[{"2":"b"},{"0":"#34495e","2":"c"}]},{"8":"mysqldumpslow","9":[{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"olss-1658649198954","5":[{"2":"2","3":"ufGA-1658649198953","7":[{"8":"在生产环境中，如果要手工分析日志，查找、分析SQL，显然是个体力活，MySQL提供了日志分析工具","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"mysqldumpslow ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"5lEC-1658723467385","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"bbzn-1658723467384","5":[{"2":"2","3":"twyX-1658649199050","7":[{"8":"[root]#  mysqldumpslow --help"}]}],"6":"cl"}],"6":"cd"},{"3":"B9Ev-1658730437351","4":{"version":1,"u":"https://note.youdao.com/yws/res/23983/WEBRESOURCEb1739ca99f2c750e82fbc3dcf24662b7","w":572,"h":398},"6":"im"},{"3":"Eel7-1658723026326","5":[{"2":"2","3":"Rzl7-1658723026324","7":[{"8":"mysqldumpslow 命令的具体参数如下：","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"orq8-1658730464297","4":{"li":"R1x9-1658730481909","lt":"unordered","ll":1},"5":[{"2":"2","3":"9Lsi-1658730464296","7":[{"8":"-a: 不将数字抽象成N，字符串抽象成S ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"ihTV-1658730464299","4":{"li":"R1x9-1658730481909","lt":"unordered","ll":1},"5":[{"2":"2","3":"8OzQ-1658730464298","7":[{"8":"-s: 是表示按照何种方式排序：","9":[{"0":"#ff0000","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"0BDY-1658730464301","4":{"li":"R1x9-1658730481909","lt":"unordered","ll":2},"5":[{"2":"2","3":"8U7k-1658730464300","7":[{"8":"c: 访问次数","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"PgM9-1658730464304","4":{"li":"R1x9-1658730481909","lt":"unordered","ll":2},"5":[{"2":"2","3":"j1Bo-1658730464303","7":[{"8":"l: 锁定时间","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"OECD-1658730464308","4":{"li":"R1x9-1658730481909","lt":"unordered","ll":2},"5":[{"2":"2","3":"BYqJ-1658730464306","7":[{"8":"r: 返回记录","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"1So7-1658730464310","4":{"li":"R1x9-1658730481909","lt":"unordered","ll":2},"5":[{"2":"2","3":"DsuU-1658730464309","7":[{"8":"t: ","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"查询时间","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"jXj3-1658730464312","4":{"li":"R1x9-1658730481909","lt":"unordered","ll":2},"5":[{"2":"2","3":"dEgQ-1658730464311","7":[{"8":"al:平均锁定时间","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"j7Rc-1658730464314","4":{"li":"R1x9-1658730481909","lt":"unordered","ll":2},"5":[{"2":"2","3":"81HQ-1658730464313","7":[{"8":"ar:平均返回记录数","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"lId0-1658730464317","4":{"li":"R1x9-1658730481909","lt":"unordered","ll":2},"5":[{"2":"2","3":"0sFo-1658730464316","7":[{"8":"at:平均查询时间 （默认方式）","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"b0zK-1658730464319","4":{"li":"R1x9-1658730481909","lt":"unordered","ll":2},"5":[{"2":"2","3":"NKLV-1658730464318","7":[{"8":"ac:平均查询次数","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"j0AD-1658730464321","4":{"li":"R1x9-1658730481909","lt":"unordered","ll":1},"5":[{"2":"2","3":"CkrJ-1658730464320","7":[{"8":"-t: 即为返回前面多少条的数据；","9":[{"0":"#ff0000","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"fBaO-1658723026834","4":{"li":"R1x9-1658730481909","lt":"unordered","ll":1},"5":[{"2":"2","3":"Q9KY-1658723026833","7":[{"8":"-g: 后边搭配一个正则匹配模式，大小写不敏感的；","9":[{"0":"#ff0000","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"TgFW-1658730709640","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"ehAA-1658730709639","5":[{"2":"2","3":"qzh6-1658723026926","7":[{"8":"mysqldumpslow -a -s t -t5 /var/lib/mysql/数据库名-slow.log","9":[{"0":"#000000","2":"c"}]}]}],"6":"cl"}],"6":"cd"},{"3":"N5gn-1658723027026","4":{"l":"h3"},"5":[{"2":"2","3":"PlKk-1658723027024","7":[{"8":"关闭慢查询日志 ","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"xgpI-1658730491728","5":[{"2":"2","3":"Tpo3-1658730491727","7":[{"8":"方式","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"1","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"：永久性方式","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"WXj0-1658730862206","5":[{"2":"2","3":"lasg-1658730862205","7":[{"8":"修改my.cnf或者my.ini 文件，保存重启","9":[{"0":"#000000","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"aef5-1658730832458","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"mOVA-1658730832457","5":[{"2":"2","3":"vtpz-1658730492231","7":[{"8":"[mysqld] slow_query_log\u003dOFF "}]}],"6":"cl"}],"6":"cd"},{"3":"qUTk-1658730492344","5":[{"2":"2","3":"sUUz-1658730492342","7":[{"8":"方式","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"2","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"：临时性方式","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"nR93-1658730915636","4":{"version":1},"5":[{"2":"2","3":"gahq-1658730915635","7":[{"8":"使用SET语句来设置。 （1）停止MySQL慢查询日志功能，具体SQL语句如下。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"eSg2-1658730924759","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"Eu13-1658730924758","5":[{"2":"2","3":"5Nri-1658730492438","7":[{"8":"SET GLOBAL slow_query_log\u003doff;"}]}],"6":"cl"}],"6":"cd"},{"3":"5DRa-1658730492537","5":[{"2":"2","3":"jWFl-1658730492535","7":[{"8":"（2）","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"重启MySQL服务","9":[{"0":"#ff0000","2":"c"},{"0":16,"2":"fs"}]},{"8":"，使用SHOW语句查询慢查询日志功能信息，具体SQL语句如下","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"eSyf-1658730946033","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"0Io6-1658730946032","5":[{"2":"2","3":"rREp-1658730492644","7":[{"8":"SHOW VARIABLES LIKE \u0027%slow%\u0027; "}]}],"6":"cl"},{"3":"8dXx-1658730947110","5":[{"2":"2","3":"4TJa-1658730947109","7":[{"8":"#以及 "}]}],"6":"cl"},{"3":"Mo1Q-1658730947113","5":[{"2":"2","3":"22FA-1658730947112","7":[{"8":"SHOW VARIABLES LIKE \u0027%long_query_time%\u0027; "}]}],"6":"cl"}],"6":"cd"},{"3":"JtxT-1658730492741","4":{"l":"h3"},"5":[{"2":"2","3":"nNFr-1658730492739","7":[{"8":"删除慢查询日志","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"QZre-1658730492838","5":[{"2":"2","3":"Mmkn-1658730492836","7":[{"8":"从执行结果可以看出，慢查询日志的目录默认为MySQL的数据目录，在该目录下手动删除慢查询日志文件即可。"}]}]},{"3":"BFO2-1658731035727","5":[{"2":"2","3":"lEH4-1658731035725","7":[{"8":"使用命令mysqladmin flush-logs来重新生成查询日志文件，具体命令如下，执行完毕会在数据目录下重新生成慢查询日志文件。"}]}]},{"3":"4ojd-1658731045540","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"anxQ-1658731045539","5":[{"2":"2","3":"bvuI-1658730492949","7":[{"8":"[root@local]# mysqladmin -uroot -p flush-logs slow"}]}],"6":"cl"}],"6":"cd"},{"3":"KIUH-1658730493052","5":[{"2":"2","3":"SU7G-1658730493049","7":[{"8":"提示"}]}]},{"3":"89pl-1658731149650","4":{"version":1},"5":[{"2":"2","3":"PzKe-1658731149649","7":[{"8":"慢查询日志都是使用mysqladmin flush-logs命令来删除重建的。使用时一定要注意，一旦执行了这个命令，慢查询日志都只存在新的日志文件中，如果需要旧的查询日志，就必须事先备份。"}]}]},{"3":"liKW-1658730493154","4":{"l":"h1"},"5":[{"2":"2","3":"XqTq-1658730493153","7":[{"8":"查看 ","9":[{"2":"b"},{"0":"#34495e","2":"c"}]},{"8":"SQL ","9":[{"0":"#34495e","2":"c"}]},{"8":"执行成本：","9":[{"2":"b"},{"0":"#34495e","2":"c"}]},{"8":"SHOW PROFILE","9":[{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"ktbt-1658731235332","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"j3uO-1658731235330","5":[{"2":"2","3":"9JGY-1658730493254","7":[{"8":"mysql \u003e show variables like \u0027profiling\u0027; #查看功能是否开启"}]}],"6":"cl"},{"3":"tQ3H-1658731272410","5":[{"2":"2","3":"HSox-1658731272408","7":[{"8":"mysql \u003e set profiling \u003d \u0027ON\u0027; "}]}],"6":"cl"}],"6":"cd"},{"3":"IYnn-1658730493344","5":[{"2":"2","3":"SGIl-1658730493342","7":[{"8":"然后执行相关的查询语句。接着看下当前会话都有哪些 profiles，使用下面这条命令：","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"OT3r-1658731297016","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"xeTu-1658731297015","5":[{"2":"2","3":"Eq4Z-1658730493441","7":[{"8":"mysql \u003e show profiles 【for query (number)】;"}]}],"6":"cl"},{"3":"tFoJ-1658731379088","5":[{"2":"2","3":"mRAM-1658731379086","7":[{"8":"mysql\u003e show profile cpu,block io for query 2;"}]}],"6":"cl"}],"6":"cd"},{"3":"uX8p-1658730493555","5":[{"2":"2","3":"rRqp-1658730493553","7":[{"8":"show profile","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"的常用查询参数：","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"XfPa-1658731384783","4":{"version":1},"5":[{"2":"2","3":"pHox-1658731384782","7":[{"8":"① ALL：显示所有的开销信息。 ② BLOCK IO：显示块IO开销。 ③ CONTEXT SWITCHES：上下文切换开销。 ④ CPU：显示CPU开销信息。 ⑤ IPC：显示发送和接收开销信息。 ⑥ MEMORY：显示内存开销信息。 ⑦ PAGE FAULTS：显示页面错误开销信息。 ⑧ SOURCE：显示和Source_function，Source_file， Source_line相关的开销信息。 ⑨ SWAPS：显示交换次数开销信息。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"gs8Q-1658731449106","4":{"li":"MNmn-1658731493300","lt":"unordered","ll":1},"5":[{"2":"2","3":"74DE-1658731449103","7":[{"8":"converting HEAP to MyISAM:查询结果太大，内存不够，数据往磁盘上搬了。"}]}],"6":"l"},{"3":"7IA7-1658731474821","4":{"li":"MNmn-1658731493300","lt":"unordered","ll":1},"5":[{"2":"2","3":"CuV7-1658731474819","7":[{"8":"creating tmp table :创建临时表。先拷贝数据到临时表，用完后再删除临时表。"}]}],"6":"l"},{"3":"9oBn-1658731482441","4":{"li":"MNmn-1658731493300","lt":"unordered","ll":1},"5":[{"2":"2","3":"IP4B-1658731482439","7":[{"8":"Copying to tmp table on disk:把内存中临时表复制到磁盘上，警惕!"}]}],"6":"l"},{"3":"T2ei-1658731468836","4":{"li":"MNmn-1658731493300","lt":"unordered","ll":1},"5":[{"2":"2","3":"ffhe-1658731468835","7":[{"8":"locked 。"}]}],"6":"l"},{"3":"65sb-1658731468838","4":{"version":1},"5":[{"2":"2","3":"Tcke-1658731468837","7":[{"8":"如果在show profile诊断结果中出现了以上4条结果中的任何一条，则sql语句需要优化。"}]}]},{"3":"GaOP-1658731512838","4":{"version":1},"5":[{"2":"2","3":"BgzT-1658731512835","7":[{"8":"注意:"}]}]},{"3":"YiOv-1658731522960","4":{"version":1},"5":[{"2":"2","3":"SEuq-1658731522959","7":[{"8":"不过SHOW PROFILE命令将被弃用，我们可以从information_schema中的profiling数据表进行查看。"}]}]},{"3":"WavX-1658730493658","4":{"l":"h1"},"5":[{"2":"2","3":"qg00-1658730493656","7":[{"8":"分析查询语句：","9":[{"2":"b"},{"0":"#34495e","2":"c"}]},{"8":"EXPLAIN ","9":[{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"EkOQ-1658731189025","4":{"l":"h3"},"5":[{"2":"2","3":"apME-1658731189023","7":[{"8":"概述","9":[{"0":"#000000","2":"c"}]}]}],"6":"h"},{"3":"jXNH-1658731189541","5":[{"2":"2","3":"8HpC-1658731189539","7":[{"8":"定位了查询慢的SQL之后，我们就可以使用EXPLAIN或DESCRIBE工具做针对性的分析查询语句。DESCRIBE语句的使用方法与EXPLAIN语句是一样的，并且分析结果也是一样的。"}]}]},{"3":"P8Bq-1658732653865","4":{"version":1},"5":[{"2":"2","3":"AB6f-1658732653864","7":[{"8":"MysQL中有专门负责优化SELECT语句的优化器模块，主要功能:通过计算分析系统中收集到的统计信息，为客户端请求的Query提供它认为最优的执行计划（他认为最优的数据检索方式，但不见得是DBA认为是最优的，这部分最耗费时间)。I"}]}]},{"3":"Mp8e-1658732653867","4":{"version":1},"5":[{"2":"2","3":"Tgyu-1658732653866","7":[{"8":"这个执行计划展示了接下来具体执行查询的方式，比如多表连接的顺序是什么，对于每个表采用什么访问方法来具体执行查询等等。MySQL为我们提供了EXPLAIN语句来帮助我们查看某个查询语句的具体执行计划，大家看懂EXPLAIN语句的各个输出项，可以有针对性的提升我们查询语句的性能。"}]}]},{"3":"Hu9w-1658731189680","4":{"li":"5HW5-1658732910730","lt":"unordered","ll":1,"s":{"in":0}},"5":[{"2":"2","3":"lJ4x-1658731189678","7":[{"8":"MySQL 5.6.3以前只能 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"EXPLAIN SELECT ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"；MYSQL 5.6.3以后就可以 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"EXPLAIN SELECT","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"，","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"UPDATE","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"， ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"DELETE ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"W00d-1658732903091","4":{"li":"5HW5-1658732910730","lt":"unordered","ll":1,"s":{"in":0}},"5":[{"2":"2","3":"KFpP-1658732903090","7":[{"8":"在5.7以前的版本中，想要显示 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"partitions ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"需要使用 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"explain partitions ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"命令；想要显示","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"filtered ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"需要使用 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"explain extended ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"命令。在5.7版本后，默认explain直接显示partitions和 filtered中的信息。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"4NfE-1658731189784","4":{"l":"h3"},"5":[{"2":"2","3":"jZ97-1658731189782","7":[{"8":"基本语法 ","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"GxCr-1658733244082","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"faD8-1658733244081","5":[{"2":"2","3":"Hpos-1658731189896","7":[{"8":"EXPLAIN SELECT select_options "}]}],"6":"cl"},{"3":"B3tC-1658733244407","5":[{"2":"2","3":"wFJ3-1658733244406","7":[{"8":"或者"}]}],"6":"cl"},{"3":"olFP-1658733244409","5":[{"2":"2","3":"iBqf-1658733244408","7":[{"8":"DESCRIBE SELECT select_options "}]}],"6":"cl"}],"6":"cd"},{"3":"3ZZ3-1658731190018","5":[{"2":"2","3":"68vu-1658731190016","7":[{"8":"如果我们想看看某个查询的执行计划的话，可以在具体的查询语句前边加一个 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"EXPLAIN","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"m8S6-1658731190132","5":[{"2":"2","3":"KIZb-1658731190131","7":[{"8":"EXPLAIN ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"语句输出的各个列的作用如下：","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"Oqx4-1658733281818","4":{"version":1,"u":"https://note.youdao.com/yws/res/23978/WEBRESOURCEcbdf9cca2d161337f85b7dd468242726","w":572,"h":428},"6":"im"},{"3":"vAx8-1658730493864","4":{"l":"h3"},"5":[{"2":"2","3":"Wlws-1658730493862","7":[{"8":"数据准备","9":[{"0":"#000000","2":"c"}]}]}],"6":"h"},{"3":"kgrg-1658734076116","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"qV1V-1658734076115","5":[{"2":"2","3":"DOvK-1658732845177","7":[{"8":"CREATE TABLE s1 ( "}]}],"6":"cl"},{"3":"59ea-1658734076837","5":[{"2":"2","3":"5pCY-1658734076836","7":[{"8":"id INT AUTO_INCREMENT, "}]}],"6":"cl"},{"3":"smqi-1658734076839","5":[{"2":"2","3":"sTa7-1658734076838","7":[{"8":"key1 VARCHAR(100), "}]}],"6":"cl"},{"3":"xYlj-1658734076841","5":[{"2":"2","3":"q7EK-1658734076840","7":[{"8":"key2 INT, "}]}],"6":"cl"},{"3":"IQcI-1658734076843","5":[{"2":"2","3":"iTHn-1658734076842","7":[{"8":"key3 VARCHAR(100), "}]}],"6":"cl"},{"3":"KcMA-1658734076845","5":[{"2":"2","3":"lRpE-1658734076844","7":[{"8":"key_part1 VARCHAR(100), "}]}],"6":"cl"},{"3":"mNAG-1658734076847","5":[{"2":"2","3":"wHsJ-1658734076846","7":[{"8":"key_part2 VARCHAR(100), "}]}],"6":"cl"},{"3":"liJh-1658734076849","5":[{"2":"2","3":"1rDT-1658734076848","7":[{"8":"key_part3 VARCHAR(100), "}]}],"6":"cl"},{"3":"rTXh-1658734076851","5":[{"2":"2","3":"2Ko4-1658734076850","7":[{"8":"common_field VARCHAR(100), "}]}],"6":"cl"},{"3":"qCA0-1658734076853","5":[{"2":"2","3":"TRUT-1658734076852","7":[{"8":"PRIMARY KEY (id), "}]}],"6":"cl"},{"3":"MyYo-1658734076855","5":[{"2":"2","3":"QDmA-1658734076854","7":[{"8":"INDEX idx_key1 (key1), "}]}],"6":"cl"},{"3":"MQ7D-1658734076857","5":[{"2":"2","3":"CfZ0-1658734076856","7":[{"8":"UNIQUE INDEX idx_key2 (key2), "}]}],"6":"cl"},{"3":"foVy-1658734076859","5":[{"2":"2","3":"KzLH-1658734076858","7":[{"8":"INDEX idx_key3 (key3), "}]}],"6":"cl"},{"3":"4pSc-1658734076861","5":[{"2":"2","3":"r2D0-1658734076860","7":[{"8":"INDEX idx_key_part(key_part1, key_part2, key_part3) "}]}],"6":"cl"},{"3":"Zbe4-1658734076863","5":[{"2":"2","3":"svo5-1658734076862","7":[{"8":") ENGINE\u003dINNODB CHARSET\u003dutf8; "}]}],"6":"cl"},{"3":"6iDY-1658734079826","5":[{"2":"2","3":"UgPz-1658734079825","7":[{"8":"CREATE TABLE s2 ( "}]}],"6":"cl"},{"3":"NEyx-1658734084269","5":[{"2":"2","3":"4LxL-1658734084268","7":[{"8":"id INT AUTO_INCREMENT, "}]}],"6":"cl"},{"3":"bAaS-1658734084271","5":[{"2":"2","3":"f42J-1658734084270","7":[{"8":"key1 VARCHAR(100), "}]}],"6":"cl"},{"3":"siSI-1658734084273","5":[{"2":"2","3":"DmJl-1658734084272","7":[{"8":"key2 INT, "}]}],"6":"cl"},{"3":"eGAr-1658734084275","5":[{"2":"2","3":"Nyg4-1658734084274","7":[{"8":"key3 VARCHAR(100), "}]}],"6":"cl"},{"3":"9fSx-1658734084277","5":[{"2":"2","3":"HH8l-1658734084276","7":[{"8":"key_part1 VARCHAR(100), "}]}],"6":"cl"},{"3":"KHLy-1658734084279","5":[{"2":"2","3":"HNp9-1658734084278","7":[{"8":"key_part2 VARCHAR(100), "}]}],"6":"cl"},{"3":"F1Jn-1658734084281","5":[{"2":"2","3":"hWlJ-1658734084280","7":[{"8":"key_part3 VARCHAR(100), "}]}],"6":"cl"},{"3":"wD2A-1658734084283","5":[{"2":"2","3":"PWOm-1658734084282","7":[{"8":"common_field VARCHAR(100), "}]}],"6":"cl"},{"3":"OLCP-1658734084285","5":[{"2":"2","3":"BKu3-1658734084284","7":[{"8":"PRIMARY KEY (id), "}]}],"6":"cl"},{"3":"BKcn-1658734084287","5":[{"2":"2","3":"uYsU-1658734084286","7":[{"8":"INDEX idx_key1 (key1), "}]}],"6":"cl"},{"3":"5wFw-1658734084289","5":[{"2":"2","3":"jlXD-1658734084288","7":[{"8":"UNIQUE INDEX idx_key2 (key2),"}]}],"6":"cl"},{"3":"0aR1-1658734087943","5":[{"2":"2","3":"JJla-1658734087942","7":[{"8":"INDEX idx_key3 (key3), "}]}],"6":"cl"},{"3":"J6k7-1658734088093","5":[{"2":"2","3":"FCLt-1658734088092","7":[{"8":"INDEX idx_key_part(key_part1, key_part2, key_part3) "}]}],"6":"cl"},{"3":"TRDh-1658734088095","5":[{"2":"2","3":"GaJE-1658734088094","7":[{"8":") ENGINE\u003dINNODB CHARSET\u003dutf8; "}]}],"6":"cl"}],"6":"cd"},{"3":"ajkb-1658732845276","5":[{"2":"2","3":"chfz-1658732845275","7":[{"8":"其他见PDF文档","9":[{"0":"#000000","2":"c"}]}]}]},{"3":"W0oz-1658732845372","4":{"l":"h3"},"5":[{"2":"2","3":"af19-1658732845371","7":[{"8":"EXPLAIN","9":[{"0":"#34495e","2":"c"}]},{"8":"各列作用","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"1zfW-1658732845487","4":{"l":"h4"},"5":[{"2":"2","3":"EBSH-1658732845485","7":[{"8":"1. table","9":[{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"zW1s-1658734524411","4":{"version":1},"5":[{"2":"2","3":"02H8-1658734524412","7":[{"8":"不论我们的查询语句有多复杂，里边儿 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"包含了多少个表 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"，到最后也是需要对每个表进行 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"单表访问 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"的，所以MySQL规定","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"EXPLAIN","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"语句输出的每条记录都对应着某个单表的访问方法","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"，该条记录的table列代表着该表的表名（有时不是真实的表名字，可能是简称）。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"bZxF-1658734679745","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"9EpC-1658734679744","5":[{"2":"2","3":"pVvo-1658734674089","7":[{"8":"EXPLAIN SELECT * FROM s1 INNER JOIN s2;"}]}],"6":"cl"},{"3":"S4L4-1658734715557","5":[{"2":"2","3":"Tb4g-1658734715556","7":[{"8":"#s1驱动表   s2被驱动表。执行结果在前的表是驱动表，（优化器可能对调顺序"}]}],"6":"cl"}],"6":"cd"},{"3":"Jive-1658732845579","4":{"l":"h4"},"5":[{"2":"2","3":"KQQo-1658732845578","7":[{"8":"2. id","9":[{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"FnIw-1658734590806","4":{"version":1},"5":[{"2":"2","3":"laeY-1658734590807","7":[{"8":"在一个大的查询语句中每个SELECT关键字都对应一个唯一的id"}]}]},{"3":"LqZV-1658734975125","4":{"version":1,"u":"https://note.youdao.com/yws/res/23979/WEBRESOURCE73c9df25e323f55a114cc30265acac95","w":572,"h":35},"6":"im"},{"3":"dLEA-1658734985128","4":{"version":1,"u":"https://note.youdao.com/yws/res/23975/WEBRESOURCE8425c91d955c695c033f528b4d0888ec","w":572,"h":28},"6":"im"},{"3":"qWhN-1658735052139","4":{"version":1,"u":"https://note.youdao.com/yws/res/23976/WEBRESOURCEaf670fd38b2b6743d648900ab432a80c","w":572,"h":62},"6":"im"},{"3":"Ckp5-1658735058147","4":{"version":1,"u":"https://note.youdao.com/yws/res/23981/WEBRESOURCEf201fa2329be88c607bbfa6496ed72d6","w":572,"h":43},"6":"im"},{"3":"8QL7-1658735041650","4":{"version":1},"5":[{"2":"2","3":"kSHC-1658735041648","7":[{"8":"去重会生成一张虚拟表"}]}]},{"3":"qmI4-1658735041761","4":{"li":"jPxl-1658735132130","lt":"unordered","ll":1},"5":[{"2":"2","3":"GfQS-1658735041760","7":[{"8":"id","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"如果相同，可以认为是一组，从上往下顺序执行","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"mcDl-1658735128951","4":{"li":"jPxl-1658735132130","lt":"unordered","ll":1},"5":[{"2":"2","3":"IUKB-1658735128950","7":[{"8":"在所有组中，","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"id","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"值越大，优先级越高，越先执行","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"nDJt-1658735128953","4":{"li":"jPxl-1658735132130","lt":"unordered","ll":1},"5":[{"2":"2","3":"qLLU-1658735128952","7":[{"8":"关注点：","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"id","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"号每个号码，表示一趟独立的查询","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":", ","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"一个","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"sql","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"的查询趟数越少越好","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"9iWl-1658732845677","4":{"l":"h4"},"5":[{"2":"2","3":"P1VK-1658732845676","7":[{"8":"3. select_typ","9":[{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"MnX9-1658735135909","4":{"version":1},"5":[{"2":"2","3":"ktZH-1658735135910","7":[{"8":"一条大的查询语句里边可以包含若干个SELECT关键字，每个SELECT关键字代表着一个小的查询语句，而每个SELECT关键字的FROM子句中都可以包含若干张表(这些表用来做连接查询)，每一张表都对应着执行计划输出中的一条记录，对于在同一个SELECT关键字中的表来说，它们的id值是相同的。"}]}]},{"3":"Ni35-1658735220003","4":{"version":1},"5":[{"2":"2","3":"Px2z-1658735220002","7":[{"8":"MysQL为每一个SELECT关键字代表的小查询都定义了一个称之为select_type的属性，意思是我们只要知道了某个小查询的select_type属性，就知道了这个小查询在整个大查询中扮演了一个什么角色，我们看一下select_type都能取哪些值，请看官方文档:"}]}]},{"3":"rVYp-1658735247201","4":{"version":1,"u":"https://note.youdao.com/yws/res/23980/WEBRESOURCE11171ee1dd2a3be1cba58505bf8b0ffa","w":572,"h":472},"6":"im"},{"3":"z5im-1658735224731","4":{"version":1},"5":[{"2":"2","3":"tFnc-1658735224729","7":[{"8":"查询语句中不包含UNION或者子查询的查询都算作是SIMPLE类型"}]}]},{"3":"9SId-1658735224912","4":{"li":"o3G9-1658735474701","lt":"unordered","ll":1},"5":[{"2":"2","3":"9XW3-1658735224911","7":[{"8":"对于包含UNION或者UNION ALL或者子查询的大查询来说，它是由几个小查询组成的，其中最左边的那个查询的select_type值就是PRIMARY"}]}],"6":"l"},{"3":"qTAC-1658735225235","4":{"li":"o3G9-1658735474701","lt":"unordered","ll":1},"5":[{"2":"2","3":"gmvQ-1658735225234","7":[{"8":"对于包含UNION或者UNION ALL的大查询来说，它是由几个小查询组成的，其中除了最左边的那个小查询以外，其余的小查询的select_type值就是UNION"}]}],"6":"l"},{"3":"MJFi-1658735225431","4":{"li":"o3G9-1658735474701","lt":"unordered","ll":1},"5":[{"2":"2","3":"rBaR-1658735225430","7":[{"8":"MySQL选择使用临时表来完成UNION查询的去重工作，针对该临时表的查询的select_type就是UNION RESULT"}]}],"6":"l"},{"3":"L0KG-1658735225621","4":{"version":1},"5":[{"2":"2","3":"qMM6-1658735225620","7":[{"8":"子查询："}]}]},{"3":"2Ccp-1658735551024","4":{"li":"5PY6-1658735773958","lt":"unordered","ll":1},"5":[{"2":"2","3":"0JBM-1658735551023","7":[{"8":"如果包含子查询的查询语句不能够转为对应的semi-join的形式，并且该子查询是不相关子查询。该子查询的第一个SELECT关键字代表的那个查询的select_type就是SUBQUERY"}]}],"6":"l"},{"3":"jpl5-1658735225734","4":{"li":"5PY6-1658735773958","lt":"unordered","ll":1},"5":[{"2":"2","3":"IsgR-1658735225732","7":[{"8":"如果包含子查询的查询语句不能够转为对应的semi-join的形式，并且该子查询是相关子查询，则该子查询的第一个SELECT关键字代表的那个查询的select_type就是DEPENDENT SUBQUERY。注意的是，select_type为DEPENDENT SUBQUERY的查询可能会被执行多次。"}]}],"6":"l"},{"3":"9jRI-1658735776441","4":{"li":"5PY6-1658735773958","lt":"unordered","ll":1},"5":[{"2":"2","3":"lbuI-1658735776440","7":[{"8":"在包含UNION或者UNION ALL的大查询中，如果各个小查询都依赖于外层查询的话，那除了最左边的那个小查询之外，其余的小查询的select_type的值就是DEPENDENT UNION。"}]}],"6":"l"},{"3":"smkP-1658735225974","4":{"version":1},"5":[{"2":"2","3":"dR98-1658735225973","7":[{"8":"对于包含派生表的查询，该派生表对应的子查询的select_type就是DERIVED。对于查询结果保存为一张表的表称作派生表。"}]}]},{"3":"lmwp-1658735658992","4":{"version":1},"5":[{"2":"2","3":"lQZu-1658735658991","7":[{"8":"当查询优化器在执行包含子查询的语句时，选择将子查询物化之后与外层查询进行连接查询时，#该子查询对应的select_type属性就是MATERIALIZED。EXPLAIN SELECT * FROM s1 WHERE key1 IN (SELECT key1 FROM s2); #子查询被转为了物化表"}]}]},{"3":"aP3b-1658732845771","4":{"l":"h4"},"5":[{"2":"2","3":"YymZ-1658732845770","7":[{"8":"4. partitions (","9":[{"0":"#34495e","2":"c"}]},{"8":"可略","9":[{"2":"b"},{"0":"#34495e","2":"c"}]},{"8":")","9":[{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"2faU-1658736263621","4":{"version":1},"5":[{"2":"2","3":"RKMS-1658736263622","7":[{"8":"代表分区表中的命中情况,非分区表，该项为NULL。一般情况下我们的查询语句的执行计划的partitions列的值都是NULL。"}]}]},{"3":"Qua5-1658732845882","4":{"l":"h4"},"5":[{"2":"2","3":"2Qi1-1658732845881","7":[{"8":"5. type ","9":[{"0":"#34495e","2":"c"}]},{"8":"☆","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"4n9L-1658736321994","4":{"version":1},"5":[{"2":"2","3":"Mg2V-1658736321995","7":[{"8":"执行计划的一条记录就代表着MySQL对某个表的执行查询时的访问方法，又称“访问类型”，其中的type列就表明了这个访问方法是啥，是较为重要的一个指标。比如，看到type列的值是ref，表明MySQL即将使用ref访问方法来执行对s1表的查询。"}]}]},{"3":"5pjQ-1658736418564","4":{"version":1},"5":[{"2":"2","3":"P0I3-1658736418563","7":[{"8":"完整的访问方法如下： ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"system ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"， ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"const ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"， ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"eq_ref ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"， ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"ref ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"， ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"fulltext ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"， ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"ref_or_null ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"， ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"index_merge ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"， ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"unique_subquery ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"， ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"index_subquery ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"， ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"range ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"， ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"index ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"， ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"ALL ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"Dwn2-1658736419067","4":{"li":"BbEO-1658737947739","lt":"unordered","ll":1},"5":[{"2":"2","3":"25Xd-1658736419065","7":[{"8":"当表中只有一条记录并且该表使用的存储引擎的统计数据是精确的，比如MyISAM、Memory，那么对该表的访问方法就是system"}]}],"6":"l"},{"3":"54E6-1658736465581","4":{"li":"BbEO-1658737947739","lt":"unordered","ll":1},"5":[{"2":"2","3":"kh5A-1658736465579","7":[{"8":"当我们根据主键或者唯一二级索引列与常数进行等值匹配时，对单表的访问方法就是const。EXPLAIN SELECT * FROM s1 WHERE id \u003d 10005;"}]}],"6":"l"},{"3":"399m-1658736465710","4":{"li":"BbEO-1658737947739","lt":"unordered","ll":1},"5":[{"2":"2","3":"AURc-1658736465709","7":[{"8":"在连接查询时，如果被驱动表是通过主键或者唯一二级索引列等值匹配的方式进行访问的（如果该主键或者唯一二级索引是联合索引的话，所有的索引列都必须进行等值比较），则对该被驱动表的访问方法就是eq_ref。EXPLAIN SELECT * FROM s1 INNER JOIN s2 ON s1.id \u003d s2.id;"}]}],"6":"l"},{"3":"GM5T-1658736462668","4":{"li":"BbEO-1658737947739","lt":"unordered","ll":1},"5":[{"2":"2","3":"A0yS-1658736462666","7":[{"8":"当通过普通的二级索引列与常量进行等值匹配时来查询某个表，那么对该表的访问方法就可能是ref。EXPLAIN SELECT * FROM s1 WHERE key1 \u003d \u0027a\u0027;"}]}],"6":"l"},{"3":"Fz2S-1658736462782","4":{"li":"BbEO-1658737947739","lt":"unordered","ll":1},"5":[{"2":"2","3":"Lmqh-1658736462780","7":[{"8":"当对普通二级索引进行等值匹配查询，该索引列的值也可以是NULL值时，那么对该表的访问方法就可能是ref_or_null。EXPLAIN SELECT * FROM s1 WHERE key1 \u003d \u0027a\u0027 OR key1 IS NULL;"}]}],"6":"l"},{"3":"6nkJ-1658737734905","4":{"li":"BbEO-1658737947739","lt":"unordered","ll":1},"5":[{"2":"2","3":"TPWg-1658737734904","7":[{"8":"单表访问方法时在某些场景下可以使用Intersection、Union、"},{"8":"Sort-Union","9":[{"0":"#FFF2CC","2":"bg"}]},{"8":"这三种索引合并的方式来执行查询。EXPLAIN SELECT * FROM s1 WHERE key1 \u003d \u0027a\u0027 OR key3 \u003d \u0027a\u0027;#type：index_merge"}]}],"6":"l"},{"3":"agWl-1658737949660","4":{"li":"BbEO-1658737947739","lt":"unordered","ll":1},"5":[{"2":"2","3":"ABJ2-1658737949658","7":[{"8":"unique_subquery是针对在一些包含IN子查询的查询语句中，如果查询优化器决定将IN子查询转换为EXISTS子查询，而且子查询可以使用到主键进行等值匹配的话，那么该子查询执行计划的type列的值就是unique_subquery。EXPLAIN SELECT * FROM s1 WHERE key2 IN (SELECT id FROM s2 WHERE s1.key1 \u003d s2.key1) OR key3 \u003d \u0027a\u0027;"}]}],"6":"l"},{"3":"g8hK-1658738084924","4":{"li":"BbEO-1658737947739","lt":"unordered","ll":1},"5":[{"2":"2","3":"AN00-1658738084922","7":[{"8":"如果使用索引获取某些范围区间的记录，那么就可能使用到range访问方法。EXPLAIN SELECT * FROM s1 WHERE key1 IN (\u0027a\u0027, \u0027b\u0027, \u0027c\u0027);EXPLAIN SELECT * FROM s1 WHERE key1 \u003e \u0027a\u0027 AND key1 \u003c \u0027b\u0027;"}]}],"6":"l"},{"3":"K5Ix-1658738134418","4":{"li":"BbEO-1658737947739","lt":"unordered","ll":1},"5":[{"2":"2","3":"hksK-1658738134417","7":[{"8":"当我们可以使用索引覆盖，但需要扫描全部的索引记录时，该表的访问方法就是index。EXPLAIN SELECT key_part2 FROM s1 WHERE key_part3 \u003d \u0027a\u0027;"}]}],"6":"l"},{"3":"nOYx-1658738255248","4":{"li":"BbEO-1658737947739","lt":"unordered","ll":1},"5":[{"2":"2","3":"SIUh-1658738255247","7":[{"8":"#最熟悉的全表扫描。EXPLAIN SELECT * FROM s1;"}]}],"6":"l"},{"3":"Q8rV-1658737837481","4":{"version":1},"5":[{"2":"2","3":"NUTB-1658737837479","7":[{"8":"结果值从最好到最坏依次是： ","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"system \u003e const \u003e eq_ref \u003e ref ","9":[{"0":"#0000ff","2":"c"},{"0":16,"2":"fs"}]},{"8":"\u003e fulltext \u003e ref_or_null \u003e index_merge \u003e unique_subquery \u003e index_subquery \u003e ","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"range \u003e index \u003e ALL ","9":[{"0":"#0000ff","2":"c"},{"0":16,"2":"fs"}]},{"8":"其中比较重要的几个提取出来（见上图中的蓝色）。","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"SQL ","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"性能优化的目标：至少要达到 ","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"range ","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"级别，要求是 ","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"ref ","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"级别，最好是 ","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"consts","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"级别。（阿里巴巴开发手册要求）","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"w7CL-1658732845981","4":{"l":"h4"},"5":[{"2":"2","3":"qPxt-1658732845980","7":[{"8":"6. possible_keys","9":[{"0":"#34495e","2":"c"}]},{"8":"和","9":[{"2":"b"},{"0":"#34495e","2":"c"}]},{"8":"key ","9":[{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"IVXj-1658738319001","4":{"version":1},"5":[{"2":"2","3":"QAAM-1658738319002","7":[{"8":"在EXPLAIN语句输出的执行计划中,"},{"8":"possible_keys列表","9":[{"0":"#FB8D00","2":"c"}]},{"8":"示在某个查询语句中，对某个表执行单表查询时可能用到的索引有哪些。一般查询涉及到的字段上若存在索引，则该索引将被列出，但不一定被查询使用。"},{"8":"key列","9":[{"0":"#FB8D00","2":"c"}]},{"8":"表示实际用到的索引有哪些，如果为NULL，则没有使用索引。"}]}]},{"3":"zBzE-1658732847702","4":{"l":"h4"},"5":[{"2":"2","3":"Q2lW-1658732847701","7":[{"8":"7. key_len ","9":[{"0":"#34495e","2":"c"}]},{"8":"☆ ","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"bARc-1658738381977","4":{"version":1},"5":[{"2":"2","3":"dtVE-1658738381978","7":[{"8":"帮你检查是否充分的利用上了索引,值越大越好，主要针对于联合索引有一定参考意义"}]}]},{"3":"qEvT-1658732848317","4":{"l":"h4"},"5":[{"2":"2","3":"9nBX-1658732848316","7":[{"8":"8. ref ","9":[{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"DXNP-1658738873363","4":{"version":1},"5":[{"2":"2","3":"Mo9c-1658738873364","7":[{"8":"当使用索引列等值查询时，与索引列进行等值匹配的对象信息"}]}]},{"3":"xCl0-1658732848413","4":{"l":"h4"},"5":[{"2":"2","3":"2LGQ-1658732848411","7":[{"8":"9. rows ","9":[{"0":"#34495e","2":"c"}]},{"8":"☆ ","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"lu37-1658740961221","4":{"version":1},"5":[{"2":"2","3":"7HoN-1658740961222","7":[{"8":"预估的需要读取的记录条数   "}]}]},{"3":"6GeC-1658732848508","4":{"l":"h4"},"5":[{"2":"2","3":"QgOe-1658732848507","7":[{"8":"10. filtered ","9":[{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"EjiK-1658741040399","4":{"version":1},"5":[{"2":"2","3":"nDKB-1658741040400","7":[{"8":"某个表经过搜索条件过滤后剩余记录条数的百分比"}]}]},{"3":"OFTu-1658741137836","4":{"version":1},"5":[{"2":"2","3":"wU2o-1658741137835","7":[{"8":"对于单表查询来说，这个filtered列的值没什么意义，我们更关注在连接查询中驱动表对应的执行计划记录的filtered值，它决定了被驱动表要执行的次数(即：rows * filtered)"}]}]},{"3":"ycis-1658732848621","4":{"l":"h4"},"5":[{"2":"2","3":"Jpwi-1658732848619","7":[{"8":"11. Extra ","9":[{"0":"#34495e","2":"c"}]},{"8":"☆ ","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"LRu1-1658741059787","4":{"version":1},"5":[{"2":"2","3":"TPsZ-1658741059788","7":[{"8":"顾名思义，Extra列是用来说明一些额外信息的，包含不适合在其他列中显示但十分重要的额外信息我们可以通过这些额外信息来更准确的理解MySQL到底将如何执行给定的查询语句。MysQL提供的额外信息有好几十个，我们就不一个一个介绍了，所以我们只挑比较重要的额外信息介绍给大家。"}]}]},{"3":"WXPU-1658822117551","4":{"version":1},"5":[{"2":"2","3":"HfDU-1658822117549","7":[{"8":"Impossible WHERE ","9":[{"0":"#e96900","2":"c"}]},{"8":"查询语句的WHERE子句永远为FALSE时将会提示该额外信息。EXPLAIN SELECT * FROM s1 WHERE 1 !\u003d 1;"}]}]},{"3":"h16N-1658822280793","4":{"version":1},"5":[{"2":"2","3":"AQ7L-1658822280792","7":[{"8":"Using where ","9":[{"0":"#e96900","2":"c"}]},{"8":"当我们使用全表扫描来执行对某个表的查询，并且该语句的WHERE，子句中有针对该表的搜索条件时，在Extra列中会提示上述额外信息。EXPLAIN SELECT * FROM s1 WHERE common_field \u003d \u0027a\u0027;当使用索引访问来执行对某个表的查询，并且该语句的WHERE子句中，有除了该索引包含的列之外的其他搜索条件时，在Extra列中也会提示上述额外信息。EXPLAIN SELECT * FROM s1 WHERE key1 \u003d \u0027a\u0027 AND common_field \u003d \u0027a\u0027;"}]}]},{"3":"2aMr-1658822117664","4":{"version":1},"5":[{"2":"2","3":"QHtD-1658822117662","7":[{"8":"No matching min/max row ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"当查询列表处有MIN或者MAX聚合函数，但是并没有符合WHERE子句中的搜索条件的记录时，将会提示该额外信息。EXPLAIN SELECT MIN(key1) FROM s1 WHERE key1 \u003d \u0027abcdefg\u0027;","9":[{"0":16,"2":"fs"}]}]}]},{"3":"1wrC-1658822117809","4":{"version":1},"5":[{"2":"2","3":"8DQC-1658822117808","7":[{"8":"Using index ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"当我们的查询列表以及搜索条件中只包含属于某个索引的列，也就是在可以使用","9":[{"0":16,"2":"fs"}]},{"8":"覆盖索引","9":[{"0":16,"2":"fs"},{"0":"#F33232","2":"c"}]},{"8":"的情况下，在Extra列将会提示该额外信息。比方说下边这个查询中只需要用到idx_key1而不需要回表操作：EXPLAIN SELECT key1,id FROM s1 WHERE key1 \u003d \u0027a\u0027;","9":[{"0":16,"2":"fs"}]}]}]},{"3":"H495-1658822117934","4":{"version":1},"5":[{"2":"2","3":"MStx-1658822117932","7":[{"8":"Using index condition ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"有些搜索条件中虽然出现了索引列，但却不能使用到索引看课件理解","9":[{"0":16,"2":"fs"}]},{"8":"索引条件下推。详情：","9":[{"0":16,"2":"fs"},{"0":"#F33232","2":"c"}]}]},{"2":"3","3":"s1A3-1658973802184","4":{"innerDocType":"note","fileStatus":"normal","hf":"note://WEB448b66ad4160da6b408b70969a4cc82d"},"5":[{"2":"2","3":"8EnB-1658973802183","7":[{"8":"索引优化与查询优化","9":[{"2":"u"},{"0":"#0366d6","2":"c"}]}]}],"6":"li"},{"2":"2","3":"oD6q-1658973802189","7":[{"8":"-条件下推。EXPLAIN SELECT * FROM s1 WHERE key1 \u003e \u0027z\u0027 AND key1 LIKE \u0027%a\u0027;","9":[{"0":16,"2":"fs"}]}]}]},{"3":"m86a-1658822118008","4":{"version":1},"5":[{"2":"2","3":"0tgC-1658822118006","7":[{"8":"Using join buffer (Block Nested Loop) ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"在连接查询执行过程中，当被驱动表不能有效的利用索引加快访问速度，MySQL一般会为其分配一块名叫join buffer的内存块来加快查询速度，也就是我们所讲的基于块的嵌套循环算法。EXPLAIN SELECT * FROM s1 INNER JOIN s2 ON s1.common_field \u003d s2.common_field;","9":[{"0":16,"2":"fs"}]}]}]},{"3":"FyQa-1658822321691","4":{"version":1},"5":[{"2":"2","3":"b5fD-1658822321689","7":[{"8":"Not exists ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"当我们使用左（外）连接时，如果WHERE子句中包含要求被驱动表的某个列等于NULL值的搜索条件，而且那个列又是不允许存储NULL值的，那么在该表的执行计划的Extra列就会提示Not exists额外信息。EXPLAIN SELECT * FROM s1 LEFT JOIN s2 ON s1.key1 \u003d s2.key1 WHERE ","9":[{"0":16,"2":"fs"}]},{"8":"s2.id IS NULL","9":[{"0":16,"2":"fs"},{"0":"#FFF2CC","2":"bg"}]},{"8":";主键不能是空值","9":[{"0":16,"2":"fs"}]}]}]},{"3":"963r-1658822321854","4":{"version":1},"5":[{"2":"2","3":"XooU-1658822321852","7":[{"8":"Using intersect(...) ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"、 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"Using union(...) ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"和 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"Using sort_union(...) ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"如果执行计划的Extra列出现了Using intersect(...)提示，说明准备使用Intersect索引合并的方式执行查询，括号中的...表示需要进行索引合并的索引名称；如果出现了Using union(...)提示，说明准备使用Union索引合并的方式执行查询；出现了Using sort_union(...)提示，说明准备使用Sort-Union索引合并的方式执行查询。EXPLAIN SELECT * FROM s1 WHERE key1 \u003d \u0027a\u0027 OR key3 \u003d \u0027a\u0027;","9":[{"0":16,"2":"fs"}]}]}]},{"3":"T0Ty-1658822332458","4":{"version":1},"5":[{"2":"2","3":"TGyV-1658822332456","7":[{"8":"Zero limit ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"当我们的LIMIT子句的参数为0时，表示压根儿不打算从表中读出任何记录，将会提示该额外信息。EXPLAIN SELECT * FROM s1 LIMIT 0;","9":[{"0":16,"2":"fs"}]}]}]},{"3":"GR41-1658822332681","4":{"version":1},"5":[{"2":"2","3":"77jF-1658822332679","7":[{"8":"Using filesort ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"很多情况下排序操作无法使用到索引，只能在内存中（记录较少的时候）或者磁盘中（记录较多的时候）进行排序，MySQL把这种在内存中或者磁盘上进行排序的方式统称为文件排序（英文名：filesort）。如果某个查询需要使用文件排序的方式执行查询，就会在执行计划的Extra列中显示Using filesort提示EXPLAIN SELECT * FROM s1 ORDER BY common_field LIMIT 10;","9":[{"0":16,"2":"fs"}]}]}]},{"3":"LzML-1658822332835","4":{"version":1},"5":[{"2":"2","3":"40Fl-1658822332834","7":[{"8":"Using temporary ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"在许多查询的执行过程中，MySQL可能会借助临时表来完成一些功能，比如去重、排序之类的，比如我们在执行许多包含DISTINCT、GROUP BY、UNION等子句的查询过程中，如果不能有效利用索引来完成查询，MySQL很有可能寻求通过建立内部的临时表来执行查询。如果查询中使用到了内部的临时表，在执行计划的Extra列将会显示Using temporary提示。EXPLAIN SELECT DISTINCT common_field FROM s1;执行计划中出现Using temporary并不是一个好的征兆，因为建立与维护临时表要付出很大成本的，所以我们最好能使用索引来替代掉使用临时表。比如:扫描指定的索引idx key1即可","9":[{"0":16,"2":"fs"}]}]}]},{"3":"aTln-1658822345517","4":{"version":1},"5":[{"2":"2","3":"USoa-1658822345516","7":[{"8":"其它","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]}]}]},{"3":"nDja-1658732848714","4":{"l":"h4"},"5":[{"2":"2","3":"CFLc-1658732848713","7":[{"8":"12. ","9":[{"0":"#34495e","2":"c"}]},{"8":"小结","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"ji4w-1658732848811","4":{"li":"fdjD-1658823965167","lt":"unordered","ll":1,"s":{"in":0}},"5":[{"2":"2","3":"rve2-1658732848810","7":[{"8":"EXPLAIN不考虑各种Cache ","9":[{"0":"#34495e","2":"c"}]}]}],"6":"l"},{"3":"47tq-1658823914634","4":{"li":"fdjD-1658823965167","lt":"unordered","ll":1,"s":{"in":0}},"5":[{"2":"2","3":"xUYC-1658823914633","7":[{"8":"EXPLAIN不能显示MySQL在执行查询时所作的优化工作","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"BN8C-1658823914636","4":{"li":"fdjD-1658823965167","lt":"unordered","ll":1,"s":{"in":0}},"5":[{"2":"2","3":"HDtz-1658823914635","7":[{"8":"EXPLAIN不会告诉你关于触发器、存储过程的信息或用户自定义函数对查询的影响情况","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"fooR-1658823914638","4":{"li":"fdjD-1658823965167","lt":"unordered","ll":1,"s":{"in":0}},"5":[{"2":"2","3":"kHKi-1658823914637","7":[{"8":"部分统计信息是估算的，并非精确值","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"Wt7D-1658732848928","4":{"l":"h1"},"5":[{"2":"2","3":"ry3S-1658732848926","7":[{"8":"EXPLAIN","9":[{"0":"#34495e","2":"c"}]},{"8":"的进一步使用","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"IGdw-1658732849022","4":{"l":"h3"},"5":[{"2":"2","3":"V3NP-1658732849020","7":[{"8":"EXPLAIN","9":[{"0":"#34495e","2":"c"}]},{"8":"四种输出格式","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"HGYH-1658732849117","5":[{"2":"2","3":"O2qY-1658732849115","7":[{"8":"这里谈谈EXPLAIN的输出格式。EXPLAIN可以输出四种格式： ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"传统格式 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"， ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"JSON","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"格式 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"， ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"TREE","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"格式 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"以及 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"可视化输出 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"。用户可以根据需要选择适用于自己的格式。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"zR4l-1658823973987","5":[{"2":"2","3":"94Ks-1658823973985","7":[{"8":"1. ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"传统格式","9":[{"2":"b"},{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"JiRa-1658824394365","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"6a4f-1658824394364","5":[{"2":"2","3":"lo0i-1658823974495","7":[{"8":"mysql\u003e EXPLAIN SELECT s1.key1, s2.key1 FROM s1 LEFT JOIN s2 ON s1.key1 \u003d s2.key1 WHERE "}]}],"6":"cl"},{"3":"vq4D-1658824394691","5":[{"2":"2","3":"zY6R-1658824394690","7":[{"8":"s2.common_field IS NOT NULL;"}]}],"6":"cl"}],"6":"cd"},{"3":"UT7p-1658823974591","5":[{"2":"2","3":"0Olm-1658823974590","7":[{"8":"2. JSON","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"格式 ","9":[{"2":"b"},{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"bFYo-1658824408219","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"AS4m-1658824408218","5":[{"2":"2","3":"Vgg8-1658823974701","7":[{"8":"EXPLAIN FORMAT\u003dJSON SELECT .... "}]}],"6":"cl"}],"6":"cd"},{"3":"LFz5-1658823974799","5":[{"2":"2","3":"kENs-1658823974798","7":[{"8":"第1种格式中介绍的EXPLAIN语句输出中缺少了一个衡量执行计划好坏的重要属性--成本。而JSON格式是四种格式里面输出信息最详尽的格式，里面包含了执行的成本信息。"}]}]},{"3":"JL6e-1658824504282","4":{"version":1,"u":"https://note.youdao.com/yws/res/23982/WEBRESOURCE62ee2f2963c6bb4884857d25aed39e81","w":572,"h":363},"6":"im"},{"3":"lgEV-1658823975008","5":[{"2":"2","3":"nSWo-1658823975006","7":[{"8":"我们使用 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"# ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"后边跟随注释的形式为大家解释了 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"EXPLAIN FORMAT\u003dJSON ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"语句的输出内容，但是大家可能有疑问 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"\"cost_info\" ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"里边的成本看着怪怪的，它们是怎么计算出来的？先看 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"s1 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"表的 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"\"cost_info\" ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"部分：","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"6Kx9-1658824709667","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"xYF4-1658824709666","5":[{"2":"2","3":"Fjg3-1658823975105","7":[{"8":"\"cost_info\": { "}]}],"6":"cl"},{"3":"UaqI-1658824710224","5":[{"2":"2","3":"zlWq-1658824710223","7":[{"8":"\"read_cost\": \"1840.84\", "}]}],"6":"cl"},{"3":"FSvZ-1658824710226","5":[{"2":"2","3":"aJBi-1658824710225","7":[{"8":"\"eval_cost\": \"193.76\", "}]}],"6":"cl"},{"3":"cwIo-1658824710228","5":[{"2":"2","3":"coXU-1658824710227","7":[{"8":"\"prefix_cost\": \"2034.60\", "}]}],"6":"cl"},{"3":"0xTj-1658824710230","5":[{"2":"2","3":"uiYm-1658824710229","7":[{"8":"\"data_read_per_join\": \"1M\" "}]}],"6":"cl"},{"3":"ixLj-1658824710232","5":[{"2":"2","3":"KiSD-1658824710231","7":[{"8":"}"}]}],"6":"cl"}],"6":"cd"},{"3":"Hkk1-1658823975200","4":{"li":"K178-1658824772273","lt":"unordered","ll":1},"5":[{"2":"2","3":"GRTR-1658823975199","7":[{"8":"read_cost ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"是由下边这两部分组成的：","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"PReL-1658824719244","4":{"li":"K178-1658824772273","lt":"unordered","ll":2},"5":[{"2":"2","3":"BzzT-1658824719243","7":[{"8":"IO ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"成本","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"mf9z-1658824719246","4":{"li":"K178-1658824772273","lt":"unordered","ll":2},"5":[{"2":"2","3":"MDqp-1658824719245","7":[{"8":"检测 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"rows × (1 - filter) ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"条记录的 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"CPU ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"成本","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"NusT-1658823975298","4":{"li":"K178-1658824772273","lt":"unordered","ll":1},"5":[{"2":"2","3":"AV5a-1658823975297","7":[{"8":"eval_cost ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"是这样计算的：检测 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"rows × filter ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"条记录的成本。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"IjCU-1658823975381","4":{"li":"K178-1658824772273","lt":"unordered","ll":1},"5":[{"2":"2","3":"zihS-1658823975379","7":[{"8":"prefix_cost ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"就是单独查询 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"s1 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"表的成本，也就是：","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"read_cost + eval_cost ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"iP5U-1658824765361","4":{"li":"K178-1658824772273","lt":"unordered","ll":1},"5":[{"2":"2","3":"Jhlr-1658824765360","7":[{"8":"data_read_per_join ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"表示在此次查询中需要读取的数据量。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"28kj-1658823975476","5":[{"2":"2","3":"I9kZ-1658823975474","7":[{"8":"小贴士： rows和filter都是我们前边介绍执行计划的输出列，在JSON格式的执行计划中，rows相当于rows_examined_per_scan，filtered名称不变。","9":[{"0":"#777777","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"7JiQ-1658823975572","5":[{"2":"2","3":"PEJ5-1658823975570","7":[{"8":"3. TREE","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"格式 ","9":[{"2":"b"},{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"mk0m-1658823975681","5":[{"2":"2","3":"bstC-1658823975680","7":[{"8":"TREE格式是8.0.16版本之后引入的新格式，主要根据查询的 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"各个部分之间的关系 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"和 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"各部分的执行顺序 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"来描述如何查询。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"TlRz-1658823975777","5":[{"2":"2","3":"tI7J-1658823975776","7":[{"8":"4. ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"可视化输出","9":[{"2":"b"},{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"Xbim-1658826436321","5":[{"2":"2","3":"WrBL-1658826436320","7":[{"8":"可视化输出，可以通过MySQL Workbench可视化查看MySQL的执行计划。通过点击Workbench的放大镜图标，即可生成可视化的查询计划。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"2StC-1658826442328","4":{"version":1},"5":[{"2":"2","3":"XJw9-1658826442327","7":[{"8":"上图按从左到右的连接顺序显示表。红色框表示 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"全表扫描 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"，而绿色框表示使用 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"索引查找 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"。对于每个表，显示使用的索引。还要注意的是，每个表格的框上方是每个表访问所发现的行数的估计值以及访问该表的成本。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"eo0n-1658826433054","4":{"l":"h3"},"5":[{"2":"2","3":"uHtG-1658826433053","7":[{"8":"SHOW WARNINGS","9":[{"0":"#34495e","2":"c"}]},{"8":"的使用 ","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"6nAV-1658823975984","5":[{"2":"2","3":"s15X-1658823975983","7":[{"8":"在我们使用EXPLAIN语句查看了某个查询的执行计划后，紧接着还可以使用SHOW WARNINGS语句查看与这个查询的执行计划有关的一些扩展信息，比如这样"}]}]},{"3":"5Y1W-1658826492453","4":{"version":1,"u":"https://note.youdao.com/yws/res/23984/WEBRESOURCE6fc2583960b3bd25524ac3ede27229a2","w":572,"h":134},"6":"im"},{"3":"LTWu-1658823976079","5":[{"2":"2","3":"vKjh-1658823976078","7":[{"8":"大家可以看到SHOW WARNINGS展示出来的信息有三个字段，分别是Level、Code、Message。我们最常见的就是Code为1003的信息，当Code值为1003时，Message字段展示的信息类似于查询优化器将我们的查询语句重写后的语句。比如我们上边的查询本来是一个左(外)连接查询，但是有一个s2.common_field IS NOTNULL的条件，这就会导致查询优化器把左（外）连接查询优化为内连接查询，从 SHOW WARNINGS的Message字段也可以看出来，原本的LEFTJOIN已经变成了JOIN。"}]}]},{"3":"rYSS-1658823976190","4":{"l":"h1"},"5":[{"2":"2","3":"tsSD-1658823976188","7":[{"8":"分析优化器执行计划：","9":[{"2":"b"},{"0":"#34495e","2":"c"}]},{"8":"trace","9":[{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"IpuN-1658824844947","5":[{"2":"2","3":"Xev8-1658824844946","7":[{"8":"OPTIMIZER_TRACE是MySQL 5.6引入的一项跟踪功能，它可以跟踪优化器做出的各种决策(比如访问表的方法、各种开销计算、各种转换等)，并将跟踪结果记录到INFORMATION_SCHEMA.OPTIMIZER_TRACE表中。"}]}]},{"3":"rP84-1658827151612","4":{"version":1},"5":[{"2":"2","3":"6JjE-1658827151611","7":[{"8":"此功能默认关闭。开启trace，并设置格式为JSON，同时设置trace最大能够使用的内存大小，避免解析过程中因为默认内存过小而不能够完整展示。"}]}]},{"3":"THc9-1658827258668","4":{"version":1},"5":[{"2":"2","3":"c16a-1658827258667","7":[{"8":"开启后，可分析如下语句：","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"omyK-1658827266080","4":{"version":1},"5":[{"2":"2","3":"jWVD-1658827266079","7":[{"8":"SELECT INSERT REPLACE UPDATE DELETE EXPLAIN SET DECLARE CASE IFRETURN CALL","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"Jznv-1658827169446","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"Zc59-1658827169445","5":[{"2":"2","3":"zSEB-1658824845453","7":[{"8":"SET optimizer_trace\u003d\"enabled\u003don\",end_markers_in_json\u003don; "}]}],"6":"cl"},{"3":"nn8g-1658827170002","5":[{"2":"2","3":"kp44-1658827170001","7":[{"8":"set optimizer_trace_max_mem_size\u003d1000000;"}]}],"6":"cl"}],"6":"cd"},{"3":"VAM1-1658827398246","5":[{"2":"2","3":"WI1t-1658827398247","7":[{"8":"测试：执行如下SQL语句","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"sWCu-1658827405738","5":[{"2":"2","3":"iwjf-1658827405736","7":[{"8":"最后， 查询 information_schema.optimizer_trace 就可以知道MySQL是如何执行SQL的 ： ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"SX62-1658827249046","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"2Ek3-1658827249045","5":[{"2":"2","3":"GpEL-1658824845550","7":[{"8":"select * from student where id \u003c 10;"}]}],"6":"cl"},{"3":"WETQ-1658827339942","5":[{"2":"2","3":"H06r-1658827339941","7":[{"8":"select * from information_schema.optimizer_trace\\G"}]}],"6":"cl"}],"6":"cd"},{"3":"Tv68-1658827454583","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"DaC2-1658827454582","5":[{"2":"2","3":"Wxfe-1658824845659","7":[{"8":"*************************** 1. row *************************** "}]}],"6":"cl"},{"3":"Wn7P-1658827455283","5":[{"2":"2","3":"5cTq-1658827455282","7":[{"8":"//第1部分：查询语句 "}]}],"6":"cl"},{"3":"SMdA-1658827455285","5":[{"2":"2","3":"m7YV-1658827455284","7":[{"8":"QUERY: select * from student where id \u003c 10 "}]}],"6":"cl"},{"3":"UzAf-1658827455287","5":[{"2":"2","3":"niza-1658827455286","7":[{"8":"//第2部分：QUERY字段对应语句的跟踪信息 "}]}],"6":"cl"},{"3":"7Dd7-1658827455289","5":[{"2":"2","3":"3gUs-1658827455288","7":[{"8":"TRACE: { "}]}],"6":"cl"},{"3":"Ql1r-1658827455291","5":[{"2":"2","3":"Uu6K-1658827455290","7":[{"8":"\"steps\": [ "}]}],"6":"cl"},{"3":"g1OE-1658827455293","5":[{"2":"2","3":"CAHA-1658827455292","7":[{"8":"{ "}]}],"6":"cl"},{"3":"gcAg-1658827466850","5":[{"2":"2","3":"ZNda-1658827466849","7":[{"8":"、、、、、、、"}]}],"6":"cl"},{"3":"Sk97-1658827466975","5":[{"2":"2","3":"ixWF-1658827466974","7":[{"8":"] /* steps */ "}]}],"6":"cl"},{"3":"DQLd-1658827473185","5":[{"2":"2","3":"eCXw-1658827473184","7":[{"8":"}"}]}],"6":"cl"},{"3":"5dwc-1658827473187","5":[{"2":"2","3":"e4Lj-1658827473186","7":[{"8":"//第3部分：跟踪信息过长时，被截断的跟踪信息的字节数。 "}]}],"6":"cl"},{"3":"4IGe-1658827473189","5":[{"2":"2","3":"LYnk-1658827473188","7":[{"8":"MISSING_BYTES_BEYOND_MAX_MEM_SIZE: 0 //丢失的超出最大容量的字节 "}]}],"6":"cl"},{"3":"no0E-1658827473191","5":[{"2":"2","3":"5j7e-1658827473190","7":[{"8":"//第4部分：执行跟踪语句的用户是否有查看对象的权限。当不具有权限时，该列信息为1且TRACE字段为空，一般在 "}]}],"6":"cl"},{"3":"stFk-1658827473193","5":[{"2":"2","3":"uIsY-1658827473192","7":[{"8":"调用带有SQL SECURITY DEFINER的视图或者是存储过程的情况下，会出现此问题。 "}]}],"6":"cl"},{"3":"ykUX-1658827473195","5":[{"2":"2","3":"cngz-1658827473194","7":[{"8":"INSUFFICIENT_PRIVILEGES: 0 //缺失权限 "}]}],"6":"cl"},{"3":"2dvQ-1658827473197","5":[{"2":"2","3":"ENwp-1658827473196","7":[{"8":"1 row in set (0.00 sec)"}]}],"6":"cl"}],"6":"cd"},{"3":"ycoI-1658824845756","4":{"l":"h1"},"5":[{"2":"2","3":"Hinp-1658824845755","7":[{"8":"MySQL","9":[{"0":"#34495e","2":"c"}]},{"8":"监控分析视图","9":[{"2":"b"},{"0":"#34495e","2":"c"}]},{"8":"-sys schema ","9":[{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"Jk7v-1658824845850","5":[{"2":"2","3":"6YZo-1658824845848","7":[{"8":"关于MySQL的性能监控和问题诊断，我们一般都从performance_schema中去获取想要的数据，在MySQL5.7.7版本中新增sys schema，它将performance_schema和information_schema中的数据以更容易理解的方式总结归纳为\"视图”，其目的就是为了降低查询performance_schema的复杂度，让DBA能够快速的定位问题。下面看看这些库中都有哪些监控表和视图，掌握了这些，在我们开发和运维的过程中就起到了事半功倍的效果。"}]}]},{"3":"c8j2-1658824845961","4":{"l":"h3"},"5":[{"2":"2","3":"RkMg-1658824845960","7":[{"8":"Sys schema","9":[{"0":"#34495e","2":"c"}]},{"8":"视图摘要 ","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"ge3v-1658827585222","4":{"version":1},"5":[{"2":"2","3":"7Ahz-1658827585221","7":[{"8":"1. ","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"主机相关：","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"以host_summary开头，主要汇总了IO延迟的信息。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"RN7r-1658827585224","4":{"version":1},"5":[{"2":"2","3":"oL32-1658827585223","7":[{"8":"2. Innodb","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"相关：","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"以innodb开头，汇总了innodb buffer信息和事务等待innodb锁的信息。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"Cw1M-1658827585226","4":{"version":1},"5":[{"2":"2","3":"gmCJ-1658827585225","7":[{"8":"3. I/o","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"相关：","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"以io开头，汇总了等待I/O、I/O使用量情况。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"sNSH-1658827585228","4":{"version":1},"5":[{"2":"2","3":"1RHb-1658827585227","7":[{"8":"4. ","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"内存使用情况：","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"以memory开头，从主机、线程、事件等角度展示内存的使用情况","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"11P6-1658827585230","4":{"version":1},"5":[{"2":"2","3":"fNNZ-1658827585229","7":[{"8":"5. ","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"连接与会话信息：","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"processlist和session相关视图，总结了会话相关信息。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"gs6z-1658827585233","4":{"version":1},"5":[{"2":"2","3":"8RBL-1658827585232","7":[{"8":"6. ","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"表相关：","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"以schema_table开头的视图，展示了表的统计信息。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"l03X-1658827585235","4":{"version":1},"5":[{"2":"2","3":"OQ05-1658827585234","7":[{"8":"7. ","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"索引信息：","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"统计了索引的使用情况，包含冗余索引和未使用的索引情况。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"GL5u-1658827585237","4":{"version":1},"5":[{"2":"2","3":"tNPs-1658827585236","7":[{"8":"8. ","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"语句相关：","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"以statement开头，包含执行全表扫描、使用临时表、排序等的语句信息。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"cozM-1658827585239","4":{"version":1},"5":[{"2":"2","3":"K0yR-1658827585238","7":[{"8":"9. ","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"用户相关：","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"以user开头的视图，统计了用户使用的文件I/O、执行语句统计信息。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"5lkV-1658827585241","4":{"version":1},"5":[{"2":"2","3":"ebJj-1658827585240","7":[{"8":"10. ","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"等待事件相关信息：","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"以wait开头，展示等待事件的延迟情况。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"XXdw-1658827595035","4":{"l":"h3"},"5":[{"2":"2","3":"0FhO-1658827595034","7":[{"8":"Sys schema","9":[{"0":"#34495e","2":"c"}]},{"8":"视图使用场景","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"JzMk-1658827531724","5":[{"2":"2","3":"5Vdu-1658827531722","7":[{"8":"索引情况","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"ou2H-1658827615475","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"Iyvh-1658827615474","5":[{"2":"2","3":"IQW5-1658827532232","7":[{"8":"#1. 查询冗余索引 "}]}],"6":"cl"},{"3":"HKAw-1658827621567","5":[{"2":"2","3":"Z8DL-1658827621566","7":[{"8":"select * from sys.schema_redundant_indexes; "}]}],"6":"cl"},{"3":"NdJB-1658827621569","5":[{"2":"2","3":"dweX-1658827621568","7":[{"8":"#2. 查询未使用过的索引 "}]}],"6":"cl"},{"3":"4Lns-1658827621571","5":[{"2":"2","3":"xSjZ-1658827621570","7":[{"8":"select * from sys.schema_unused_indexes; "}]}],"6":"cl"},{"3":"ipAs-1658827621573","5":[{"2":"2","3":"7Vo3-1658827621572","7":[{"8":"#3. 查询索引的使用情况 "}]}],"6":"cl"},{"3":"2mXr-1658827621575","5":[{"2":"2","3":"zJ89-1658827621574","7":[{"8":"select index_name,rows_selected,rows_inserted,rows_updated,rows_deleted"}]}],"6":"cl"},{"3":"SrMI-1658827621577","5":[{"2":"2","3":"r7ih-1658827621576","7":[{"8":"from sys.schema_index_statistics where table_schema\u003d\u0027dbname\u0027 ;"}]}],"6":"cl"}],"6":"cd"},{"3":"l0vx-1658827532332","5":[{"2":"2","3":"BeRE-1658827532330","7":[{"8":"表相关","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"Wy0d-1658827632274","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"aiJM-1658827632273","5":[{"2":"2","3":"r6yT-1658827532441","7":[{"8":"# 1. 查询表的访问量 "}]}],"6":"cl"},{"3":"pa5P-1658827632785","5":[{"2":"2","3":"VM5z-1658827632784","7":[{"8":"select table_schema,table_name,sum(io_read_requests+io_write_requests) as io from "}]}],"6":"cl"},{"3":"tPG5-1658827632787","5":[{"2":"2","3":"1sKs-1658827632786","7":[{"8":"sys.schema_table_statistics group by table_schema,table_name order by io desc; "}]}],"6":"cl"},{"3":"3auu-1658827632789","5":[{"2":"2","3":"qCnc-1658827632788","7":[{"8":"# 2. 查询占用bufferpool较多的表 "}]}],"6":"cl"},{"3":"Fkjy-1658827632791","5":[{"2":"2","3":"qage-1658827632790","7":[{"8":"select object_schema,object_name,allocated,data"}]}],"6":"cl"},{"3":"LIK1-1658827632793","5":[{"2":"2","3":"jJ73-1658827632792","7":[{"8":"from sys.innodb_buffer_stats_by_table order by allocated limit 10; "}]}],"6":"cl"},{"3":"stP5-1658827632795","5":[{"2":"2","3":"lYJy-1658827632794","7":[{"8":"# 3. 查看表的全表扫描情况 "}]}],"6":"cl"},{"3":"aIQr-1658827632797","5":[{"2":"2","3":"xjSB-1658827632796","7":[{"8":"select * from sys.statements_with_full_table_scans where db\u003d\u0027dbname\u0027; "}]}],"6":"cl"}],"6":"cd"},{"3":"TEwl-1658827532538","5":[{"2":"2","3":"LsDg-1658827532536","7":[{"8":"语句相关","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"qbpJ-1658827643393","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"zyQe-1658827643392","5":[{"2":"2","3":"whmS-1658827532635","7":[{"8":"#1. 监控SQL执行的频率 "}]}],"6":"cl"},{"3":"Q6ed-1658827643616","5":[{"2":"2","3":"ho8M-1658827643615","7":[{"8":"select db,exec_count,query from sys.statement_analysis "}]}],"6":"cl"},{"3":"zYID-1658827643618","5":[{"2":"2","3":"0YYv-1658827643617","7":[{"8":"order by exec_count desc; "}]}],"6":"cl"},{"3":"qYSx-1658827643620","5":[{"2":"2","3":"eTCi-1658827643619","7":[{"8":"#2. 监控使用了排序的SQL "}]}],"6":"cl"},{"3":"vHvb-1658827643622","5":[{"2":"2","3":"AqrY-1658827643621","7":[{"8":"select db,exec_count,first_seen,last_seen,query"}]}],"6":"cl"},{"3":"WDNk-1658827643624","5":[{"2":"2","3":"V7MP-1658827643623","7":[{"8":"from sys.statements_with_sorting limit 1; "}]}],"6":"cl"},{"3":"JGPF-1658827643626","5":[{"2":"2","3":"kr8b-1658827643625","7":[{"8":"#3. 监控使用了临时表或者磁盘临时表的SQL "}]}],"6":"cl"},{"3":"YJje-1658827643628","5":[{"2":"2","3":"mfVj-1658827643627","7":[{"8":"select db,exec_count,tmp_tables,tmp_disk_tables,query"}]}],"6":"cl"},{"3":"LiTY-1658827643630","5":[{"2":"2","3":"y2ii-1658827643629","7":[{"8":"from sys.statement_analysis where tmp_tables\u003e0 or tmp_disk_tables \u003e0 "}]}],"6":"cl"},{"3":"oxVa-1658827643632","5":[{"2":"2","3":"xymg-1658827643631","7":[{"8":"order by (tmp_tables+tmp_disk_tables) desc;"}]}],"6":"cl"}],"6":"cd"},{"3":"xAX7-1658827600347","5":[{"2":"2","3":"QuUI-1658827600346","7":[{"8":"IO","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"相关","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"aSAI-1658827652931","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"dL6q-1658827652930","5":[{"2":"2","3":"CtV9-1658827600863","7":[{"8":"#1. 查看消耗磁盘IO的文件 "}]}],"6":"cl"},{"3":"jBeg-1658827653209","5":[{"2":"2","3":"7ct1-1658827653208","7":[{"8":"select file,avg_read,avg_write,avg_read+avg_write as avg_io"}]}],"6":"cl"},{"3":"jAni-1658827653211","5":[{"2":"2","3":"Ww1v-1658827653210","7":[{"8":"from sys.io_global_by_file_by_bytes order by avg_read limit 10; "}]}],"6":"cl"}],"6":"cd"},{"3":"nnyj-1658827600960","5":[{"2":"2","3":"neBA-1658827600959","7":[{"8":"Innodb ","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"相关","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"6eZl-1658827671433","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"lTSv-1658827671432","5":[{"2":"2","3":"coFA-1658827601054","7":[{"8":"#1. 行锁阻塞情况 "}]}],"6":"cl"},{"3":"NZ3j-1658827675688","5":[{"2":"2","3":"51Qa-1658827675687","7":[{"8":"select * from sys.innodb_lock_waits;"}]}],"6":"cl"}],"6":"cd"},{"3":"53vJ-1658827686774","5":[{"2":"2","3":"Etqu-1658827686775","7":[{"8":"风险提示:"}]}]},{"3":"jom7-1658828085745","4":{"version":1},"5":[{"2":"2","3":"D3Q2-1658828085744","7":[{"8":"通过sys库去查询时，MySQL会消耗大量资源去收集相关信息，严重的可能会导致业务请求被阻塞，从而引起故障。建议生产上不要频繁的去查询sys或者performance_schema、information_schema来完成监控、巡检等工作。"}]}]},{"3":"7Zwd-1658827688648","5":[{"2":"2","3":"62iZ-1658827688646"}]}],"__compress__":true,"title":""}