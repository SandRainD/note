<?xml version="1.0" encoding="UTF-8" standalone="no"?><note xmlns="http://note.youdao.com" file-version="0" schema-version="1.0.3"><head/><body><para><coId>1251-1638694580535</coId><text>Spring Cloud封装了Netflix 公司开发的Eureka模块来实现服务治理</text><inline-styles/><styles/></para><para><coId>2578-1638695141415</coId><text>在传统的rpc远程调用框架中，管理每个服务与服务之间依赖关系比较复杂，管理比较复杂，所以需要使用服务治理，管理服务与服务之间依赖关系，可以实现服务调用、负载均衡、容错等，实现服务发现与注册。</text><inline-styles/><styles/></para><image><coId>4200-1638861998699</coId><source>https://note.youdao.com/yws/res/15678/4286AD9BD4EA4ADCBC7DBB277016079F</source><text/><styles><width>620</width><height>190</height></styles></image><heading compat="true" level="2"><coId>8420-1638695297077</coId><text>服务注册与发现</text><inline-styles><bold><from>0</from><to>7</to><value>true</value></bold><font-size><from>0</from><to>7</to><value>20</value></font-size></inline-styles><styles/></heading><para><coId>3327-1638695315000</coId><text>Eureka采用了CS的设计架构，Eureka Sever作为服务注册功能的服务器，它是服务注册中心。而系统中的其他微服务，使用Eureka的客户端连接到 Eureka Sever并维持心跳连接。这样系统的维护人员就可以通过Eureka Server来监控系统中各个微服务是否正常运行。</text><inline-styles/><styles/></para><para><coId>6040-1638695333155</coId><text>在服务注册与发现中，有一个注册中心。当服务器启动的时候，会把当前自己服务器的信息比如服务地址通讯地址等以别名方式注册到注册中心上。另一方(消费者服务提供者)，以该别名的方式去注册中心上获取到实际的服务通讯地址，然后再实现本地RPC调用RPC远程调用框架核心设计思想:在于注册中心，因为使用注册中心管理每个服务与服务之间的一个依赖关系(服务治理概念)。在任何rpc远程框架中，都会有一个注册中心(存放服务地址相关信息(接口地址))</text><inline-styles/><styles/></para><image><coId>7235-1638695360463</coId><source>https://note.youdao.com/yws/res/15486/49EAE2E1F92D4A7B97DF1A4986842044</source><text/><styles><width>368</width><height>239</height></styles></image><para><coId>4935-1638695360463</coId><text/><inline-styles/><styles/></para><heading compat="true" level="a"><coId>5610-1638701659066</coId><text>Eureka服务注册</text><inline-styles><bold><from>0</from><to>10</to><value>true</value></bold><font-size><from>0</from><to>10</to><value>32</value></font-size></inline-styles><styles/></heading><para><coId>1961-1638703042489</coId><text>创建eureka服务：</text><inline-styles><back-color><from>0</from><to>11</to><value>#FAE220</value></back-color></inline-styles><styles/></para><para><coId>2513-1638701668399</coId><text>1、创建module</text><inline-styles><font-size><from>0</from><to>10</to><value>16</value></font-size></inline-styles><styles/></para><para><coId>4066-1638701702956</coId><text>2、配置pom.xml</text><inline-styles><font-size><from>0</from><to>11</to><value>16</value></font-size></inline-styles><styles/></para><table><coId>9268-1638701758725</coId><resource-list/><content>{"cells":[{"value":"&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.idea.springcloud&lt;/groupId&gt;\n        &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n        &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n        &lt;scope&gt;test&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;junit&lt;/groupId&gt;\n        &lt;artifactId&gt;junit&lt;/artifactId&gt;\n        &lt;scope&gt;test&lt;/scope&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;","inlineStyles":{"font-size":[{"from":0,"to":14,"value":13},{"from":15,"to":31,"value":13},{"from":32,"to":84,"value":13},{"from":85,"to":160,"value":13},{"from":161,"to":178,"value":13},{"from":179,"to":195,"value":13},{"from":196,"to":243,"value":13},{"from":244,"to":294,"value":13},{"from":295,"to":312,"value":13},{"from":313,"to":329,"value":13},{"from":330,"to":381,"value":13},{"from":382,"to":438,"value":13},{"from":439,"to":456,"value":13},{"from":457,"to":473,"value":13},{"from":474,"to":525,"value":13},{"from":526,"to":587,"value":13},{"from":588,"to":605,"value":13},{"from":606,"to":622,"value":13},{"from":623,"to":667,"value":13},{"from":668,"to":707,"value":13},{"from":708,"to":725,"value":13},{"from":726,"to":742,"value":13},{"from":743,"to":794,"value":13},{"from":795,"to":852,"value":13},{"from":853,"to":880,"value":13},{"from":881,"to":898,"value":13},{"from":899,"to":915,"value":13},{"from":916,"to":948,"value":13},{"from":949,"to":987,"value":13},{"from":988,"to":1015,"value":13},{"from":1016,"to":1033,"value":13},{"from":1034,"to":1049,"value":13}],"color":[{"from":0,"to":14,"value":"#e8bf6a"},{"from":15,"to":31,"value":"#e8bf6a"},{"from":32,"to":49,"value":"#e8bf6a"},{"from":49,"to":74,"value":"#a9b7c6"},{"from":74,"to":84,"value":"#e8bf6a"},{"from":85,"to":105,"value":"#e8bf6a"},{"from":105,"to":147,"value":"#a9b7c6"},{"from":147,"to":160,"value":"#e8bf6a"},{"from":161,"to":178,"value":"#e8bf6a"},{"from":179,"to":195,"value":"#e8bf6a"},{"from":196,"to":213,"value":"#e8bf6a"},{"from":213,"to":233,"value":"#a9b7c6"},{"from":233,"to":243,"value":"#e8bf6a"},{"from":244,"to":264,"value":"#e8bf6a"},{"from":264,"to":281,"value":"#a9b7c6"},{"from":281,"to":294,"value":"#e8bf6a"},{"from":295,"to":312,"value":"#e8bf6a"},{"from":313,"to":329,"value":"#e8bf6a"},{"from":330,"to":347,"value":"#e8bf6a"},{"from":347,"to":371,"value":"#a9b7c6"},{"from":371,"to":381,"value":"#e8bf6a"},{"from":382,"to":402,"value":"#e8bf6a"},{"from":402,"to":425,"value":"#a9b7c6"},{"from":425,"to":438,"value":"#e8bf6a"},{"from":439,"to":456,"value":"#e8bf6a"},{"from":457,"to":473,"value":"#e8bf6a"},{"from":474,"to":491,"value":"#e8bf6a"},{"from":491,"to":515,"value":"#a9b7c6"},{"from":515,"to":525,"value":"#e8bf6a"},{"from":526,"to":546,"value":"#e8bf6a"},{"from":546,"to":574,"value":"#a9b7c6"},{"from":574,"to":587,"value":"#e8bf6a"},{"from":588,"to":605,"value":"#e8bf6a"},{"from":606,"to":622,"value":"#e8bf6a"},{"from":623,"to":640,"value":"#e8bf6a"},{"from":640,"to":657,"value":"#a9b7c6"},{"from":657,"to":667,"value":"#e8bf6a"},{"from":668,"to":688,"value":"#e8bf6a"},{"from":688,"to":694,"value":"#a9b7c6"},{"from":694,"to":707,"value":"#e8bf6a"},{"from":708,"to":725,"value":"#e8bf6a"},{"from":726,"to":742,"value":"#e8bf6a"},{"from":743,"to":760,"value":"#e8bf6a"},{"from":760,"to":784,"value":"#a9b7c6"},{"from":784,"to":794,"value":"#e8bf6a"},{"from":795,"to":815,"value":"#e8bf6a"},{"from":815,"to":839,"value":"#a9b7c6"},{"from":839,"to":852,"value":"#e8bf6a"},{"from":853,"to":868,"value":"#e8bf6a"},{"from":868,"to":872,"value":"#a9b7c6"},{"from":872,"to":880,"value":"#e8bf6a"},{"from":881,"to":898,"value":"#e8bf6a"},{"from":899,"to":915,"value":"#e8bf6a"},{"from":916,"to":933,"value":"#e8bf6a"},{"from":933,"to":938,"value":"#a9b7c6"},{"from":938,"to":948,"value":"#e8bf6a"},{"from":949,"to":969,"value":"#e8bf6a"},{"from":969,"to":974,"value":"#a9b7c6"},{"from":974,"to":987,"value":"#e8bf6a"},{"from":988,"to":1003,"value":"#e8bf6a"},{"from":1003,"to":1007,"value":"#a9b7c6"},{"from":1007,"to":1015,"value":"#e8bf6a"},{"from":1016,"to":1033,"value":"#e8bf6a"},{"from":1034,"to":1049,"value":"#e8bf6a"}],"back-color":[{"from":0,"to":14,"value":"#2b2b2b"},{"from":15,"to":31,"value":"#2b2b2b"},{"from":32,"to":84,"value":"#2b2b2b"},{"from":85,"to":160,"value":"#2b2b2b"},{"from":161,"to":178,"value":"#2b2b2b"},{"from":179,"to":195,"value":"#2b2b2b"},{"from":196,"to":243,"value":"#2b2b2b"},{"from":244,"to":294,"value":"#2b2b2b"},{"from":295,"to":312,"value":"#2b2b2b"},{"from":313,"to":329,"value":"#2b2b2b"},{"from":330,"to":381,"value":"#2b2b2b"},{"from":382,"to":438,"value":"#2b2b2b"},{"from":439,"to":456,"value":"#2b2b2b"},{"from":457,"to":473,"value":"#2b2b2b"},{"from":474,"to":525,"value":"#2b2b2b"},{"from":526,"to":587,"value":"#2b2b2b"},{"from":588,"to":605,"value":"#2b2b2b"},{"from":606,"to":622,"value":"#2b2b2b"},{"from":623,"to":667,"value":"#2b2b2b"},{"from":668,"to":707,"value":"#2b2b2b"},{"from":708,"to":725,"value":"#2b2b2b"},{"from":726,"to":742,"value":"#2b2b2b"},{"from":743,"to":794,"value":"#2b2b2b"},{"from":795,"to":852,"value":"#2b2b2b"},{"from":853,"to":880,"value":"#2b2b2b"},{"from":881,"to":898,"value":"#2b2b2b"},{"from":899,"to":915,"value":"#2b2b2b"},{"from":916,"to":948,"value":"#2b2b2b"},{"from":949,"to":987,"value":"#2b2b2b"},{"from":988,"to":1015,"value":"#2b2b2b"},{"from":1016,"to":1033,"value":"#2b2b2b"},{"from":1034,"to":1049,"value":"#2b2b2b"}]}}],"heights":[40],"widths":[620]}</content><styles/></table><para><coId>2271-1638701729304</coId><text>3、配置yml</text><inline-styles><font-size><from>0</from><to>7</to><value>16</value></font-size></inline-styles><styles/></para><table><coId>3829-1638701794664</coId><resource-list/><content>{"cells":[{"value":"server:\n  port: 7001\n\neureka:\n  instance:\n    hostname: localhost\n  client:\n    register-with-eureka: false\n    #不检索自己\n    fetch-registry: false\n    #不注册自己\n    service-url:\n      defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/\n      #设置与eureka server交互的地址查询服务和注册服务都需要依赖这个地址","inlineStyles":{"italic":[{"from":112,"to":118,"value":true},{"from":119,"to":123,"value":true},{"from":149,"to":155,"value":true},{"from":156,"to":160,"value":true},{"from":256,"to":296,"value":true}],"font-family":[{"from":113,"to":118,"value":"SimSun"},{"from":119,"to":123,"value":"SimSun"},{"from":150,"to":155,"value":"SimSun"},{"from":156,"to":160,"value":"SimSun"},{"from":257,"to":260,"value":"SimSun"},{"from":273,"to":296,"value":"SimSun"}],"font-size":[{"from":0,"to":7,"value":13},{"from":8,"to":20,"value":13},{"from":22,"to":29,"value":13},{"from":30,"to":41,"value":13},{"from":42,"to":65,"value":13},{"from":66,"to":75,"value":13},{"from":76,"to":107,"value":13},{"from":108,"to":118,"value":13},{"from":119,"to":144,"value":13},{"from":145,"to":155,"value":13},{"from":156,"to":172,"value":13},{"from":173,"to":249,"value":13},{"from":250,"to":296,"value":13}],"color":[{"from":0,"to":6,"value":"#cc7832"},{"from":6,"to":7,"value":"#a9b7c6"},{"from":8,"to":10,"value":"#a9b7c6"},{"from":10,"to":14,"value":"#cc7832"},{"from":14,"to":16,"value":"#a9b7c6"},{"from":16,"to":20,"value":"#6897bb"},{"from":22,"to":28,"value":"#cc7832"},{"from":28,"to":29,"value":"#a9b7c6"},{"from":30,"to":32,"value":"#a9b7c6"},{"from":32,"to":40,"value":"#cc7832"},{"from":40,"to":41,"value":"#a9b7c6"},{"from":42,"to":46,"value":"#a9b7c6"},{"from":46,"to":54,"value":"#cc7832"},{"from":54,"to":65,"value":"#a9b7c6"},{"from":66,"to":68,"value":"#a9b7c6"},{"from":68,"to":74,"value":"#cc7832"},{"from":74,"to":75,"value":"#a9b7c6"},{"from":76,"to":80,"value":"#a9b7c6"},{"from":80,"to":100,"value":"#cc7832"},{"from":100,"to":102,"value":"#a9b7c6"},{"from":102,"to":107,"value":"#cc7832"},{"from":108,"to":112,"value":"#cc7832"},{"from":112,"to":118,"value":"#629755"},{"from":119,"to":123,"value":"#629755"},{"from":123,"to":137,"value":"#cc7832"},{"from":137,"to":139,"value":"#a9b7c6"},{"from":139,"to":144,"value":"#cc7832"},{"from":145,"to":149,"value":"#cc7832"},{"from":149,"to":155,"value":"#629755"},{"from":156,"to":160,"value":"#629755"},{"from":160,"to":171,"value":"#cc7832"},{"from":171,"to":172,"value":"#a9b7c6"},{"from":173,"to":179,"value":"#a9b7c6"},{"from":179,"to":190,"value":"#cc7832"},{"from":190,"to":201,"value":"#a9b7c6"},{"from":201,"to":225,"value":"#cc7832"},{"from":225,"to":229,"value":"#a9b7c6"},{"from":229,"to":240,"value":"#cc7832"},{"from":240,"to":249,"value":"#a9b7c6"},{"from":250,"to":256,"value":"#a9b7c6"},{"from":256,"to":296,"value":"#629755"}],"back-color":[{"from":0,"to":7,"value":"#2b2b2b"},{"from":8,"to":20,"value":"#2b2b2b"},{"from":22,"to":29,"value":"#2b2b2b"},{"from":30,"to":41,"value":"#2b2b2b"},{"from":42,"to":65,"value":"#2b2b2b"},{"from":66,"to":75,"value":"#2b2b2b"},{"from":76,"to":107,"value":"#2b2b2b"},{"from":108,"to":118,"value":"#2b2b2b"},{"from":119,"to":144,"value":"#2b2b2b"},{"from":145,"to":155,"value":"#2b2b2b"},{"from":156,"to":172,"value":"#2b2b2b"},{"from":173,"to":249,"value":"#2b2b2b"},{"from":250,"to":296,"value":"#2b2b2b"}]}}],"heights":[40],"widths":[620]}</content><styles/></table><para><coId>7614-1638701737409</coId><text>4、创建主类并启动eureka</text><inline-styles><font-size><from>0</from><to>15</to><value>16</value></font-size></inline-styles><styles/></para><table><coId>5943-1638701807046</coId><resource-list/><content>{"cells":[{"value":"@SpringBootApplication\n@EnableEurekaServer\npublic class EurekaMain7001 {\n    public static void main(String[] args) {\n        SpringApplication.run(EurekaMain7001.class,args);\n    }\n}","inlineStyles":{"italic":[{"from":144,"to":147,"value":true}],"font-size":[{"from":0,"to":22,"value":13},{"from":23,"to":42,"value":13},{"from":43,"to":72,"value":13},{"from":73,"to":117,"value":13},{"from":118,"to":175,"value":13},{"from":176,"to":181,"value":13},{"from":182,"to":183,"value":13}],"color":[{"from":0,"to":22,"value":"#bbb529"},{"from":23,"to":42,"value":"#bbb529"},{"from":43,"to":56,"value":"#cc7832"},{"from":56,"to":72,"value":"#a9b7c6"},{"from":73,"to":77,"value":"#a9b7c6"},{"from":77,"to":96,"value":"#cc7832"},{"from":96,"to":100,"value":"#ffc66d"},{"from":100,"to":117,"value":"#a9b7c6"},{"from":118,"to":163,"value":"#a9b7c6"},{"from":163,"to":169,"value":"#cc7832"},{"from":169,"to":174,"value":"#a9b7c6"},{"from":174,"to":175,"value":"#cc7832"},{"from":176,"to":180,"value":"#cc7832"},{"from":180,"to":181,"value":"#a9b7c6"},{"from":182,"to":183,"value":"#a9b7c6"}],"back-color":[{"from":0,"to":22,"value":"#2b2b2b"},{"from":23,"to":42,"value":"#2b2b2b"},{"from":43,"to":72,"value":"#2b2b2b"},{"from":73,"to":117,"value":"#2b2b2b"},{"from":118,"to":175,"value":"#2b2b2b"},{"from":176,"to":181,"value":"#2b2b2b"},{"from":182,"to":183,"value":"#2b2b2b"}]}}],"heights":[40],"widths":[620]}</content><styles/></table><para><coId>6875-1638701668546</coId><text>5、浏览器输入localhost:7001</text><inline-styles><font-size><from>0</from><to>21</to><value>16</value></font-size></inline-styles><styles/></para><para><coId>8638-1638702926957</coId><text/><inline-styles/><styles/></para><heading compat="true" level="2"><coId>4919-1638701668680</coId><text>将支付模块加入eureka服务管理中（注册）</text><inline-styles><bold><from>0</from><to>22</to><value>true</value></bold><font-size><from>0</from><to>22</to><value>20</value></font-size><color><from>0</from><to>22</to><value>#df402a</value></color></inline-styles><styles/></heading><para><coId>7929-1638701669429</coId><text>1、在支付模块pom.xml中加入依赖</text><inline-styles><font-size><from>0</from><to>19</to><value>16</value></font-size></inline-styles><styles/></para><table><coId>1650-1638702104822</coId><resource-list/><content>{"cells":[{"value":"&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;\n&lt;/dependency&gt;","inlineStyles":{"font-size":[{"from":0,"to":12,"value":13},{"from":13,"to":61,"value":13},{"from":62,"to":133,"value":13},{"from":134,"to":147,"value":13}],"color":[{"from":0,"to":12,"value":"#e8bf6a"},{"from":13,"to":26,"value":"#e8bf6a"},{"from":26,"to":51,"value":"#a9b7c6"},{"from":51,"to":61,"value":"#e8bf6a"},{"from":62,"to":78,"value":"#e8bf6a"},{"from":78,"to":120,"value":"#a9b7c6"},{"from":120,"to":133,"value":"#e8bf6a"},{"from":134,"to":147,"value":"#e8bf6a"}],"back-color":[{"from":0,"to":12,"value":"#2b2b2b"},{"from":13,"to":61,"value":"#2b2b2b"},{"from":62,"to":133,"value":"#2b2b2b"},{"from":134,"to":147,"value":"#2b2b2b"}]}}],"heights":[44.06668472290039],"widths":[620]}</content><styles/></table><para><coId>3810-1638701669929</coId><text>2、主类中加@EnableEurekaClient</text><inline-styles><font-size><from>0</from><to>6</to><value>16</value></font-size><font-size><from>6</from><to>25</to><value>13</value></font-size><color><from>6</from><to>25</to><value>#bbb529</value></color><back-color><from>6</from><to>25</to><value>#2b2b2b</value></back-color></inline-styles><styles/></para><para><coId>7698-1638701669976</coId><text>3、yml添加配置</text><inline-styles><font-size><from>0</from><to>9</to><value>16</value></font-size></inline-styles><styles/></para><table><coId>9636-1638702817374</coId><resource-list/><content>{"cells":[{"value":"eureka:\n  client:\n    register-with-eureka: true #表示是否将自己注册进eurekaserver\n    fetch-registry: true #是否从eurekaserver抓取己有的注册信息，单节点无所谓，集群必须设置true才能配置和ribbon使用负载均衡\n    service-url:\n      defaultZone: http://localhost:7001/eureka","inlineStyles":{"italic":[{"from":49,"to":72,"value":true},{"from":73,"to":77,"value":true},{"from":98,"to":158,"value":true},{"from":159,"to":163,"value":true}],"font-family":[{"from":50,"to":60,"value":"SimSun"},{"from":99,"to":102,"value":"SimSun"},{"from":114,"to":137,"value":"SimSun"},{"from":141,"to":146,"value":"SimSun"},{"from":152,"to":158,"value":"SimSun"},{"from":159,"to":163,"value":"SimSun"}],"font-size":[{"from":0,"to":7,"value":13},{"from":8,"to":17,"value":13},{"from":18,"to":72,"value":13},{"from":73,"to":158,"value":13},{"from":159,"to":175,"value":13},{"from":176,"to":223,"value":13}],"color":[{"from":0,"to":6,"value":"#cc7832"},{"from":6,"to":7,"value":"#a9b7c6"},{"from":8,"to":10,"value":"#a9b7c6"},{"from":10,"to":16,"value":"#cc7832"},{"from":16,"to":17,"value":"#a9b7c6"},{"from":18,"to":22,"value":"#a9b7c6"},{"from":22,"to":42,"value":"#cc7832"},{"from":42,"to":44,"value":"#a9b7c6"},{"from":44,"to":49,"value":"#cc7832"},{"from":49,"to":72,"value":"#629755"},{"from":73,"to":77,"value":"#629755"},{"from":77,"to":91,"value":"#cc7832"},{"from":91,"to":93,"value":"#a9b7c6"},{"from":93,"to":98,"value":"#cc7832"},{"from":98,"to":158,"value":"#629755"},{"from":159,"to":163,"value":"#629755"},{"from":163,"to":174,"value":"#cc7832"},{"from":174,"to":175,"value":"#a9b7c6"},{"from":176,"to":182,"value":"#a9b7c6"},{"from":182,"to":193,"value":"#cc7832"},{"from":193,"to":223,"value":"#a9b7c6"}],"back-color":[{"from":0,"to":7,"value":"#2b2b2b"},{"from":8,"to":17,"value":"#2b2b2b"},{"from":18,"to":72,"value":"#2b2b2b"},{"from":73,"to":158,"value":"#2b2b2b"},{"from":159,"to":175,"value":"#2b2b2b"},{"from":176,"to":223,"value":"#2b2b2b"}]}}],"heights":[40],"widths":[620]}</content><styles/></table><para><coId>7753-1638701670039</coId><text>同时也可以将订单order80加入注册eureka</text><inline-styles><italic><from>0</from><to>25</to><value>true</value></italic><underline><from>0</from><to>25</to><value>true</value></underline><font-size><from>0</from><to>25</to><value>16</value></font-size></inline-styles><styles/></para><para><coId>9471-1638703906606</coId><text/><inline-styles/><styles/></para><heading compat="true" level="2"><coId>6854-1638703899826</coId><text>eureka集群</text><inline-styles><bold><from>0</from><to>8</to><value>true</value></bold><font-size><from>0</from><to>8</to><value>20</value></font-size><color><from>0</from><to>8</to><value>#df402a</value></color></inline-styles><styles/></heading><image><coId>2818-1638703888086</coId><source>https://note.youdao.com/yws/res/15525/C5507BE9954C437BA9B40C961D1F68CC</source><text/><styles><width>620</width><height>244</height></styles></image><para><coId>2049-1638701670131</coId><text>1、创建一个新的module eure7011,过程略参照上</text><inline-styles><font-size><from>0</from><to>30</to><value>16</value></font-size></inline-styles><styles/></para><para><coId>6630-1638704694036</coId><text>2、相互注册   eureka7001:</text><inline-styles><font-size><from>0</from><to>20</to><value>16</value></font-size></inline-styles><styles/></para><table><coId>7436-1638705056578</coId><resource-list/><content>{"cells":[{"value":"server:\n  port: 7001\n\neureka:\n  instance:\n    hostname: eureka7001.com\n  client:\n    register-with-eureka: false\n    fetch-registry: false\n    service-url:\n      defaultZone: http://eureka7011.com:7011/eureka/","inlineStyles":{"italic":[{"from":113,"to":117,"value":true},{"from":139,"to":143,"value":true}],"font-family":[{"from":113,"to":117,"value":"SimSun"},{"from":139,"to":143,"value":"SimSun"}],"font-size":[{"from":0,"to":7,"value":13},{"from":8,"to":20,"value":13},{"from":22,"to":29,"value":13},{"from":30,"to":41,"value":13},{"from":42,"to":70,"value":13},{"from":71,"to":80,"value":13},{"from":81,"to":112,"value":13},{"from":113,"to":138,"value":13},{"from":139,"to":155,"value":13},{"from":156,"to":209,"value":13}],"color":[{"from":0,"to":6,"value":"#cc7832"},{"from":6,"to":7,"value":"#a9b7c6"},{"from":8,"to":10,"value":"#a9b7c6"},{"from":10,"to":14,"value":"#cc7832"},{"from":14,"to":16,"value":"#a9b7c6"},{"from":16,"to":20,"value":"#6897bb"},{"from":22,"to":28,"value":"#cc7832"},{"from":28,"to":29,"value":"#a9b7c6"},{"from":30,"to":32,"value":"#a9b7c6"},{"from":32,"to":40,"value":"#cc7832"},{"from":40,"to":41,"value":"#a9b7c6"},{"from":42,"to":46,"value":"#a9b7c6"},{"from":46,"to":54,"value":"#cc7832"},{"from":54,"to":70,"value":"#a9b7c6"},{"from":71,"to":73,"value":"#a9b7c6"},{"from":73,"to":79,"value":"#cc7832"},{"from":79,"to":80,"value":"#a9b7c6"},{"from":81,"to":85,"value":"#a9b7c6"},{"from":85,"to":105,"value":"#cc7832"},{"from":105,"to":112,"value":"#a9b7c6"},{"from":113,"to":117,"value":"#629755"},{"from":117,"to":131,"value":"#cc7832"},{"from":131,"to":138,"value":"#a9b7c6"},{"from":139,"to":143,"value":"#629755"},{"from":143,"to":154,"value":"#cc7832"},{"from":154,"to":155,"value":"#a9b7c6"},{"from":156,"to":162,"value":"#a9b7c6"},{"from":162,"to":173,"value":"#cc7832"},{"from":173,"to":209,"value":"#a9b7c6"}],"back-color":[{"from":0,"to":7,"value":"#2b2b2b"},{"from":8,"to":20,"value":"#2b2b2b"},{"from":22,"to":29,"value":"#2b2b2b"},{"from":30,"to":41,"value":"#2b2b2b"},{"from":42,"to":70,"value":"#2b2b2b"},{"from":71,"to":80,"value":"#2b2b2b"},{"from":81,"to":112,"value":"#2b2b2b"},{"from":113,"to":138,"value":"#2b2b2b"},{"from":139,"to":155,"value":"#2b2b2b"},{"from":156,"to":209,"value":"#2b2b2b"}]}}],"heights":[40],"widths":[620]}</content><styles/></table><para><coId>4623-1638701670161</coId><text>eureka7011:</text><inline-styles><font-size><from>0</from><to>11</to><value>16</value></font-size></inline-styles><styles/></para><table><coId>2695-1638705083970</coId><resource-list/><content>{"cells":[{"value":"server:\n  port: 7011\n\neureka:\n  instance:\n    hostname: eureka7011.com\n  client:\n    register-with-eureka: false\n    fetch-registry: false\n    service-url:\n      defaultZone: http://eureka7001.com:7001/eureka/","inlineStyles":{"italic":[{"from":113,"to":117,"value":true},{"from":139,"to":143,"value":true}],"font-family":[{"from":113,"to":117,"value":"SimSun"},{"from":139,"to":143,"value":"SimSun"}],"font-size":[{"from":0,"to":7,"value":13},{"from":8,"to":20,"value":13},{"from":22,"to":29,"value":13},{"from":30,"to":41,"value":13},{"from":42,"to":70,"value":13},{"from":71,"to":80,"value":13},{"from":81,"to":112,"value":13},{"from":113,"to":138,"value":13},{"from":139,"to":155,"value":13},{"from":156,"to":209,"value":13}],"color":[{"from":0,"to":6,"value":"#cc7832"},{"from":6,"to":7,"value":"#a9b7c6"},{"from":8,"to":10,"value":"#a9b7c6"},{"from":10,"to":14,"value":"#cc7832"},{"from":14,"to":16,"value":"#a9b7c6"},{"from":16,"to":20,"value":"#6897bb"},{"from":22,"to":28,"value":"#cc7832"},{"from":28,"to":29,"value":"#a9b7c6"},{"from":30,"to":32,"value":"#a9b7c6"},{"from":32,"to":40,"value":"#cc7832"},{"from":40,"to":41,"value":"#a9b7c6"},{"from":42,"to":46,"value":"#a9b7c6"},{"from":46,"to":54,"value":"#cc7832"},{"from":54,"to":70,"value":"#a9b7c6"},{"from":71,"to":73,"value":"#a9b7c6"},{"from":73,"to":79,"value":"#cc7832"},{"from":79,"to":80,"value":"#a9b7c6"},{"from":81,"to":85,"value":"#a9b7c6"},{"from":85,"to":105,"value":"#cc7832"},{"from":105,"to":112,"value":"#a9b7c6"},{"from":113,"to":117,"value":"#629755"},{"from":117,"to":131,"value":"#cc7832"},{"from":131,"to":138,"value":"#a9b7c6"},{"from":139,"to":143,"value":"#629755"},{"from":143,"to":154,"value":"#cc7832"},{"from":154,"to":155,"value":"#a9b7c6"},{"from":156,"to":162,"value":"#a9b7c6"},{"from":162,"to":173,"value":"#cc7832"},{"from":173,"to":209,"value":"#a9b7c6"}],"back-color":[{"from":0,"to":7,"value":"#2b2b2b"},{"from":8,"to":20,"value":"#2b2b2b"},{"from":22,"to":29,"value":"#2b2b2b"},{"from":30,"to":41,"value":"#2b2b2b"},{"from":42,"to":70,"value":"#2b2b2b"},{"from":71,"to":80,"value":"#2b2b2b"},{"from":81,"to":112,"value":"#2b2b2b"},{"from":113,"to":138,"value":"#2b2b2b"},{"from":139,"to":155,"value":"#2b2b2b"},{"from":156,"to":209,"value":"#2b2b2b"}]}}],"heights":[40],"widths":[620]}</content><styles/></table><para><coId>5577-1638701670191</coId><text>3、将各个模块添加进入两个eureka服务中去(order也修改一下，之后用)，需要修改yml文件</text><inline-styles><font-size><from>0</from><to>49</to><value>16</value></font-size></inline-styles><styles/></para><table><coId>7418-1638706640346</coId><resource-list/><content>{"cells":[{"value":"service-url:\n    defaultZone: http://eureka7001.com:7001/eureka,http://eureka7011.com:7011/eureka","inlineStyles":{"font-size":[{"from":0,"to":12,"value":13},{"from":13,"to":97,"value":13}],"color":[{"from":0,"to":11,"value":"#cc7832"},{"from":11,"to":12,"value":"#a9b7c6"},{"from":13,"to":28,"value":"#cc7832"},{"from":28,"to":97,"value":"#a9b7c6"}],"back-color":[{"from":0,"to":12,"value":"#2b2b2b"},{"from":13,"to":97,"value":"#2b2b2b"}]}}],"heights":[40],"widths":[620]}</content><styles/></table><para><coId>7115-1638706618166</coId><text/><inline-styles/><styles/></para><para><coId>6149-1638701670240</coId><text>创建更多的payment8002支付模块，高可用</text><inline-styles><bold><from>0</from><to>24</to><value>true</value></bold><font-size><from>0</from><to>24</to><value>20</value></font-size><color><from>0</from><to>24</to><value>#df402a</value></color></inline-styles><styles/></para><para><coId>1083-1638701670273</coId><text>1、创建过程同上</text><inline-styles><font-size><from>0</from><to>8</to><value>16</value></font-size></inline-styles><styles/></para><para><coId>6959-1638707784074</coId><text>2、修改controller层添加server port参数（用于服务调用是可以区别两个payment）</text><inline-styles><font-size><from>0</from><to>52</to><value>16</value></font-size></inline-styles><styles/></para><table><coId>9177-1638707803333</coId><resource-list/><content>{"cells":[{"value":"@Value(\"${server.port}\")\nprivate String serverPort;\nreturn new CommonResult(200,\"success serverport\"+serverPort,result);","inlineStyles":{"font-size":[{"from":0,"to":24,"value":13},{"from":25,"to":51,"value":13},{"from":52,"to":120,"value":13}],"color":[{"from":0,"to":6,"value":"#bbb529"},{"from":6,"to":7,"value":"#a9b7c6"},{"from":7,"to":23,"value":"#6a8759"},{"from":23,"to":24,"value":"#a9b7c6"},{"from":25,"to":33,"value":"#cc7832"},{"from":33,"to":40,"value":"#a9b7c6"},{"from":40,"to":50,"value":"#9876aa"},{"from":50,"to":51,"value":"#cc7832"},{"from":52,"to":63,"value":"#cc7832"},{"from":63,"to":76,"value":"#a9b7c6"},{"from":76,"to":79,"value":"#6897bb"},{"from":79,"to":80,"value":"#cc7832"},{"from":80,"to":100,"value":"#6a8759"},{"from":100,"to":101,"value":"#a9b7c6"},{"from":101,"to":111,"value":"#9876aa"},{"from":111,"to":112,"value":"#cc7832"},{"from":112,"to":119,"value":"#a9b7c6"},{"from":119,"to":120,"value":"#cc7832"}],"back-color":[{"from":0,"to":24,"value":"#2b2b2b"},{"from":25,"to":51,"value":"#2b2b2b"},{"from":52,"to":120,"value":"#2b2b2b"}]}}],"heights":[40],"widths":[620]}</content><styles/></table><para><coId>6793-1638701670305</coId><text>3、修改order consumer中controller层中的Payment_url为微服务中的Payment微服务名称</text><inline-styles><font-size><from>0</from><to>61</to><value>16</value></font-size></inline-styles><styles/></para><table><coId>5610-1638709423641</coId><resource-list/><content>{"cells":[{"value":"//    public static final String PAYMENT_URL =  \"http://localhost:8001\";","inlineStyles":{"font-size":[{"from":0,"to":72,"value":13}],"color":[{"from":0,"to":72,"value":"#808080"}],"back-color":[{"from":0,"to":72,"value":"#2b2b2b"}]}},{"value":"    public static final String PAYMENT_URL =  \"http://SPRINGCLOUD-PAYMENT\";","inlineStyles":{"italic":[{"from":31,"to":43,"value":true}],"font-size":[{"from":0,"to":75,"value":13}],"color":[{"from":0,"to":4,"value":"#808080"},{"from":4,"to":24,"value":"#cc7832"},{"from":24,"to":31,"value":"#a9b7c6"},{"from":31,"to":43,"value":"#9876aa"},{"from":43,"to":46,"value":"#a9b7c6"},{"from":46,"to":74,"value":"#6a8759"},{"from":74,"to":75,"value":"#cc7832"}],"back-color":[{"from":0,"to":75,"value":"#2b2b2b"}]}}],"heights":[40,40],"widths":[620]}</content><styles/></table><para><coId>2825-1638701670335</coId><text>4、修改RestTemplate，添加@LoadBalanced注解，表示赋予RestTemplate负载均衡的能力</text><inline-styles><font-size><from>0</from><to>58</to><value>16</value></font-size></inline-styles><styles/></para><table><coId>8470-1638709538620</coId><resource-list/><content>{"cells":[{"value":"@Configuration\npublic class ApplicationContextConfig {\n    @Bean\n    @LoadBalanced\n    public RestTemplate getRestTemplate(){\n        return  new RestTemplate();\n    }\n}","inlineStyles":{"font-size":[{"from":0,"to":14,"value":13},{"from":15,"to":54,"value":13},{"from":55,"to":64,"value":13},{"from":65,"to":82,"value":13},{"from":83,"to":125,"value":13},{"from":126,"to":161,"value":13},{"from":162,"to":167,"value":13},{"from":168,"to":169,"value":13}],"color":[{"from":0,"to":14,"value":"#bbb529"},{"from":15,"to":28,"value":"#cc7832"},{"from":28,"to":54,"value":"#a9b7c6"},{"from":55,"to":59,"value":"#a9b7c6"},{"from":59,"to":64,"value":"#bbb529"},{"from":65,"to":82,"value":"#bbb529"},{"from":83,"to":87,"value":"#bbb529"},{"from":87,"to":94,"value":"#cc7832"},{"from":94,"to":107,"value":"#a9b7c6"},{"from":107,"to":122,"value":"#ffc66d"},{"from":122,"to":125,"value":"#a9b7c6"},{"from":126,"to":134,"value":"#a9b7c6"},{"from":134,"to":146,"value":"#cc7832"},{"from":146,"to":160,"value":"#a9b7c6"},{"from":160,"to":161,"value":"#cc7832"},{"from":162,"to":166,"value":"#cc7832"},{"from":166,"to":167,"value":"#a9b7c6"},{"from":168,"to":169,"value":"#a9b7c6"}],"back-color":[{"from":0,"to":14,"value":"#2b2b2b"},{"from":15,"to":54,"value":"#2b2b2b"},{"from":55,"to":64,"value":"#2b2b2b"},{"from":65,"to":82,"value":"#2b2b2b"},{"from":83,"to":125,"value":"#2b2b2b"},{"from":126,"to":161,"value":"#2b2b2b"},{"from":162,"to":167,"value":"#2b2b2b"},{"from":168,"to":169,"value":"#2b2b2b"}]}}],"heights":[40],"widths":[620]}</content><styles/></table><para><coId>1255-1638701670399</coId><text/><inline-styles/><styles/></para><para><coId>1043-1638701670430</coId><text>服务完善：1payment支付模块yml文件修改（添加  instance</text><inline-styles><font-size><from>0</from><to>37</to><value>16</value></font-size><back-color><from>0</from><to>4</to><value>#FAE220</value></back-color></inline-styles><styles/></para><para><coId>5187-1638710164459</coId><text>配置自己的微服务名称，可以在eureka中显示出来</text><inline-styles><font-size><from>0</from><to>25</to><value>16</value></font-size></inline-styles><styles/></para><table><coId>3039-1638710103506</coId><resource-list/><content>{"cells":[{"value":"instance:\n  instance-id: payment8001","inlineStyles":{"font-size":[{"from":0,"to":9,"value":13},{"from":10,"to":36,"value":13}],"color":[{"from":0,"to":8,"value":"#cc7832"},{"from":8,"to":9,"value":"#a9b7c6"},{"from":10,"to":12,"value":"#a9b7c6"},{"from":12,"to":23,"value":"#cc7832"},{"from":23,"to":36,"value":"#a9b7c6"}],"back-color":[{"from":0,"to":9,"value":"#2b2b2b"},{"from":10,"to":36,"value":"#2b2b2b"}]}}],"heights":[40],"widths":[620]}</content><styles/></table><para><coId>2692-1638710190865</coId><text/><inline-styles/><styles/></para><table><coId>4838-1638710190865</coId><resource-list/><content>{"cells":[{"value":"instance:\n  instance-id: payment8002","inlineStyles":{"font-size":[{"from":0,"to":9,"value":13},{"from":10,"to":36,"value":13}],"color":[{"from":0,"to":8,"value":"#cc7832"},{"from":8,"to":9,"value":"#a9b7c6"},{"from":10,"to":12,"value":"#a9b7c6"},{"from":12,"to":23,"value":"#cc7832"},{"from":23,"to":36,"value":"#a9b7c6"}],"back-color":[{"from":0,"to":9,"value":"#2b2b2b"},{"from":10,"to":36,"value":"#2b2b2b"}]}}],"heights":[40],"widths":[620]}</content><styles/></table><para><coId>3995-1638701670462</coId><text>2主机显示ip地址</text><inline-styles><font-size><from>0</from><to>9</to><value>16</value></font-size></inline-styles><styles/></para><para><coId>5020-1638710287992</coId><text>在instance中</text><inline-styles><font-size><from>0</from><to>10</to><value>16</value></font-size></inline-styles><styles/></para><table><coId>3360-1638710297528</coId><resource-list/><content>{"cells":[{"value":"instance:\n  instance-id: payment8001\n  prefer-ip-address: true","inlineStyles":{"font-size":[{"from":0,"to":9,"value":13},{"from":10,"to":36,"value":13},{"from":37,"to":62,"value":13}],"color":[{"from":0,"to":8,"value":"#cc7832"},{"from":8,"to":9,"value":"#a9b7c6"},{"from":10,"to":12,"value":"#a9b7c6"},{"from":12,"to":23,"value":"#cc7832"},{"from":23,"to":36,"value":"#a9b7c6"},{"from":37,"to":56,"value":"#cc7832"},{"from":56,"to":58,"value":"#a9b7c6"},{"from":58,"to":62,"value":"#cc7832"}],"back-color":[{"from":0,"to":9,"value":"#2b2b2b"},{"from":10,"to":36,"value":"#2b2b2b"},{"from":37,"to":62,"value":"#2b2b2b"}]}}],"heights":[40],"widths":[620]}</content><styles/></table><attach><coId>4811-1638854853699</coId><source>https://note.youdao.com/yws/res/15603/20F0707042E5471FB971B96E1601800E</source><resource>https://note.youdao.com/yws/res/15604/EAE8411F212C40E0BA9CA8CDB8FBA23B</resource><filename>springcloud.zip</filename><filelength>49173</filelength><styles/></attach><heading compat="true" level="a"><coId>7534-1638701670524</coId><text>服务发现</text><inline-styles><bold><from>0</from><to>4</to><value>true</value></bold><font-size><from>0</from><to>4</to><value>32</value></font-size></inline-styles><styles/></heading><para><coId>9478-1638854559586</coId><text>对于注册进eureka里面的微服务，可以通过服务发现来获得改服务的信息</text><inline-styles/><styles/></para><para><coId>2964-1638854560097</coId><text>1、在payment8001中修改controller层</text><inline-styles/><styles/></para><table><coId>4920-1638854916336</coId><resource-list/><content>{"cells":[{"value":"@Resource\nprivate DiscoveryClient discoveryClient;\n\n\n@GetMapping(value = \"payment/discovery\")\npublic Object discovery(){\n    List&lt;String&gt; services = discoveryClient.getServices();\n    for (String service : services) {\n        log.info(\"****service\"+service);\n    }\n    List&lt;ServiceInstance&gt; instances = discoveryClient.getInstances(\"springcloud-payment\");\n    for (ServiceInstance instance : instances) {\n        log.info(instance.getServiceId()+\"\\t\"+instance.getHost()+\"\\t\"+instance.getPort()+\"\\t\"+instance.getUri());\n    }\n    return this.discoveryClient;\n}","inlineStyles":{"italic":[{"from":226,"to":229,"value":true},{"from":413,"to":416,"value":true}],"font-size":[{"from":0,"to":9,"value":13},{"from":10,"to":50,"value":13},{"from":53,"to":93,"value":13},{"from":94,"to":120,"value":13},{"from":121,"to":179,"value":13},{"from":180,"to":217,"value":13},{"from":218,"to":258,"value":13},{"from":259,"to":264,"value":13},{"from":265,"to":355,"value":13},{"from":356,"to":404,"value":13},{"from":405,"to":518,"value":13},{"from":519,"to":524,"value":13},{"from":525,"to":557,"value":13},{"from":558,"to":559,"value":13}],"color":[{"from":0,"to":9,"value":"#bbb529"},{"from":10,"to":18,"value":"#cc7832"},{"from":18,"to":34,"value":"#a9b7c6"},{"from":34,"to":49,"value":"#9876aa"},{"from":49,"to":50,"value":"#cc7832"},{"from":53,"to":64,"value":"#bbb529"},{"from":64,"to":73,"value":"#a9b7c6"},{"from":73,"to":92,"value":"#6a8759"},{"from":92,"to":93,"value":"#a9b7c6"},{"from":94,"to":101,"value":"#cc7832"},{"from":101,"to":108,"value":"#a9b7c6"},{"from":108,"to":117,"value":"#ffc66d"},{"from":117,"to":120,"value":"#a9b7c6"},{"from":121,"to":149,"value":"#a9b7c6"},{"from":149,"to":164,"value":"#9876aa"},{"from":164,"to":178,"value":"#a9b7c6"},{"from":178,"to":179,"value":"#cc7832"},{"from":180,"to":188,"value":"#cc7832"},{"from":188,"to":217,"value":"#a9b7c6"},{"from":218,"to":226,"value":"#a9b7c6"},{"from":226,"to":229,"value":"#9876aa"},{"from":229,"to":235,"value":"#a9b7c6"},{"from":235,"to":248,"value":"#6a8759"},{"from":248,"to":257,"value":"#a9b7c6"},{"from":257,"to":258,"value":"#cc7832"},{"from":259,"to":263,"value":"#cc7832"},{"from":263,"to":264,"value":"#a9b7c6"},{"from":265,"to":303,"value":"#a9b7c6"},{"from":303,"to":318,"value":"#9876aa"},{"from":318,"to":332,"value":"#a9b7c6"},{"from":332,"to":353,"value":"#6a8759"},{"from":353,"to":354,"value":"#a9b7c6"},{"from":354,"to":355,"value":"#cc7832"},{"from":356,"to":364,"value":"#cc7832"},{"from":364,"to":404,"value":"#a9b7c6"},{"from":405,"to":413,"value":"#a9b7c6"},{"from":413,"to":416,"value":"#9876aa"},{"from":416,"to":446,"value":"#a9b7c6"},{"from":446,"to":447,"value":"#6a8759"},{"from":447,"to":449,"value":"#cc7832"},{"from":449,"to":450,"value":"#6a8759"},{"from":450,"to":470,"value":"#a9b7c6"},{"from":470,"to":471,"value":"#6a8759"},{"from":471,"to":473,"value":"#cc7832"},{"from":473,"to":474,"value":"#6a8759"},{"from":474,"to":494,"value":"#a9b7c6"},{"from":494,"to":495,"value":"#6a8759"},{"from":495,"to":497,"value":"#cc7832"},{"from":497,"to":498,"value":"#6a8759"},{"from":498,"to":517,"value":"#a9b7c6"},{"from":517,"to":518,"value":"#cc7832"},{"from":519,"to":523,"value":"#cc7832"},{"from":523,"to":524,"value":"#a9b7c6"},{"from":525,"to":529,"value":"#a9b7c6"},{"from":529,"to":540,"value":"#cc7832"},{"from":540,"to":541,"value":"#a9b7c6"},{"from":541,"to":556,"value":"#9876aa"},{"from":556,"to":557,"value":"#cc7832"},{"from":558,"to":559,"value":"#a9b7c6"}],"back-color":[{"from":0,"to":9,"value":"#2b2b2b"},{"from":10,"to":50,"value":"#2b2b2b"},{"from":53,"to":93,"value":"#2b2b2b"},{"from":94,"to":120,"value":"#2b2b2b"},{"from":121,"to":179,"value":"#2b2b2b"},{"from":180,"to":217,"value":"#2b2b2b"},{"from":218,"to":258,"value":"#2b2b2b"},{"from":259,"to":264,"value":"#2b2b2b"},{"from":265,"to":355,"value":"#2b2b2b"},{"from":356,"to":404,"value":"#2b2b2b"},{"from":405,"to":518,"value":"#2b2b2b"},{"from":519,"to":524,"value":"#2b2b2b"},{"from":525,"to":557,"value":"#2b2b2b"},{"from":558,"to":559,"value":"#2b2b2b"}]}}],"heights":[40],"widths":[620]}</content><styles/></table><para><coId>3912-1638854560157</coId><text>2、在主类上添加注解@EnableDiscoveryClient</text><inline-styles><font-size><from>0</from><to>10</to><value>16</value></font-size><font-size><from>10</from><to>32</to><value>13</value></font-size><color><from>10</from><to>32</to><value>#bbb529</value></color><back-color><from>10</from><to>32</to><value>#2b2b2b</value></back-color></inline-styles><styles/></para><para><coId>9382-1638854560187</coId><text/><inline-styles/><styles/></para><para><coId>6021-1638854560221</coId><text/><inline-styles/><styles/></para><heading compat="true" level="a"><coId>2599-1638854560268</coId><text>eureka自我保护</text><inline-styles><bold><from>0</from><to>10</to><value>true</value></bold><font-size><from>0</from><to>10</to><value>32</value></font-size></inline-styles><styles/></heading><image><coId>1934-1638856614520</coId><source>https://note.youdao.com/yws/res/15613/5A8AF95F45DB4422A7192A1987B2FDA2</source><text/><styles><width>620</width><height>110</height></styles></image><para><coId>7882-1638856612652</coId><text/><inline-styles/><styles/></para><para><coId>9384-1638855991947</coId><text>保护模式主要用于一组客户端和Eureka Server之间存在网络分区场景下的保护。一旦进入保护模式，</text><inline-styles/><styles/></para><para><coId>4117-1638855991947</coId><text>Eureka Server将会尝试保护其服务注册表中的信息，不再删除服务注册表中的数据，也就是不会注销任何微服务。</text><inline-styles/><styles/></para><para><coId>4590-1638855991947</coId><text>设计思想：属于CAP里面的AP分支</text><inline-styles><font-size><from>0</from><to>17</to><value>16</value></font-size></inline-styles><styles/></para><para><coId>1898-1638854560360</coId><text/><inline-styles/><styles/></para><para><coId>4959-1638854560392</coId><text>为什么会产生Eureka自我保护机制?</text><inline-styles><color><from>0</from><to>19</to><value>#528cd8</value></color></inline-styles><styles/></para><para><coId>4925-1638856161940</coId><text>为了防LdEurekaClient可以正常运行，但是与EurekaServer网络不通情况下，EurekaServer不会立刻将EurekaClient服务剔除</text><inline-styles/><styles/></para><para><coId>4540-1638856161940</coId><text/><inline-styles/><styles/></para><para><coId>2250-1638854560454</coId><text>什么是自我保护模式?</text><inline-styles><color><from>0</from><to>10</to><value>#528cd8</value></color></inline-styles><styles/></para><para><coId>4830-1638856382345</coId><text>默认情况下，如果EurekaServer在一定时间内没有接收到某个微服务实例的心跳，EurekaServer将会注销该实例（默认90秒)。但是当网络分区故障发生(延时、卡顿、拥挤)时，微服务与EurekaServer之间无法正常通信，以上行为可能变得非常危险了——因为微服务本身其实是健康的，此时本不应该注销这个微服务。Eureka通过“自我保护模求”来解决这个问题——当EurekaServer节点在短时间内丢失过多客户端时(可能发生了网络分区故障)，那么这个节点就会进入自我保护模式。</text><inline-styles/><styles/></para><para><coId>4794-1638856382345</coId><text/><inline-styles/><styles/></para><image><coId>8393-1638856452383</coId><source>https://note.youdao.com/yws/res/15622/8F73F742EDD747B0A84E98F7BCF6624A</source><text/><styles><width>620</width><height>134</height></styles></image><para><coId>9053-1638854560529</coId><text/><inline-styles/><styles/></para><para><coId>9363-1638854560563</coId><text>自我保护机制:默认情况下EurekaClient定时向EurekaServer端发送心跳包</text><inline-styles/><styles/></para><para><coId>2940-1638856464448</coId><text>如果Eureka在server端在一定时间内(默认90秒)没有收到EurekaClient发送心跳包，便会直接从服务注册列表中剔除该服务，但是在短时间( 90秒中)内丢失了大量的服务实例心跳，这时候EurekaServer会开启自我保护机制，不会剔除该服务（该现象可能出现在如果网络不通但是EurekaClient为出现宕机，此时如果换做别的注册中心如果一定时间内没有收到心跳会将剔除该服务，这样就出现了严重失误，因为客户端还能正常发送心跳，只是网络延迟问题，而保护机制是为了解决此问题而产生的)</text><inline-styles/><styles/></para><para><coId>3157-1638856464448</coId><text/><inline-styles/><styles/></para><para><coId>9021-1638854560594</coId><text>禁用自我保护：</text><inline-styles><font-size><from>0</from><to>7</to><value>16</value></font-size></inline-styles><styles/></para><para><coId>5058-1638856813485</coId><text>在eureka7001的yml配置文件eureka中，</text><inline-styles><font-size><from>0</from><to>27</to><value>16</value></font-size></inline-styles><styles/></para><table><coId>5436-1638856872276</coId><resource-list/><content>{"cells":[{"value":"server:\n  enable-self-preservation: false\n  eviction-interval-timer-in-ms: 2000 #超过2秒就认为服务已经死亡","inlineStyles":{"font-size":[{"from":0,"to":7,"value":13},{"from":8,"to":41,"value":13},{"from":42,"to":94,"value":13}],"color":[{"from":0,"to":6,"value":"#cc7832"},{"from":6,"to":7,"value":"#a9b7c6"},{"from":8,"to":10,"value":"#a9b7c6"},{"from":10,"to":34,"value":"#cc7832"},{"from":34,"to":36,"value":"#a9b7c6"},{"from":36,"to":41,"value":"#cc7832"},{"from":42,"to":73,"value":"#cc7832"},{"from":73,"to":75,"value":"#a9b7c6"},{"from":75,"to":94,"value":"#6897bb"}],"back-color":[{"from":0,"to":7,"value":"#2b2b2b"},{"from":8,"to":41,"value":"#2b2b2b"},{"from":42,"to":44,"value":"#2b2b2b"},{"from":73,"to":75,"value":"#2b2b2b"}]}}],"heights":[40],"widths":[620]}</content><styles/></table><para><coId>3737-1638856645516</coId><text>在payment8001yml配置文件中，</text><inline-styles><font-size><from>0</from><to>21</to><value>16</value></font-size></inline-styles><styles/></para><table><coId>4681-1638857585006</coId><resource-list/><content>{"cells":[{"value":"instance:\n  instance-id: payment8001\n  prefer-ip-address: true\n  lease-renewal-interval-in-seconds: 1    #eureka客户端向服务器发送心跳时间的间隔默认30s，now：1s\n  lease-expiration-duration-in-seconds: 2  #Eureka服务端在收到最后一次心跳后等待时间上限，单位为秒(默认是90秒)，超时将剔除服务","inlineStyles":{"italic":[{"from":105,"to":140,"value":true},{"from":141,"to":143,"value":true},{"from":184,"to":231,"value":true}],"font-family":[{"from":112,"to":130,"value":"SimSun"},{"from":133,"to":134,"value":"SimSun"},{"from":137,"to":138,"value":"SimSun"},{"from":191,"to":215,"value":"SimSun"},{"from":216,"to":219,"value":"SimSun"},{"from":221,"to":222,"value":"SimSun"},{"from":223,"to":231,"value":"SimSun"}],"font-size":[{"from":0,"to":9,"value":13},{"from":10,"to":36,"value":13},{"from":37,"to":62,"value":13},{"from":63,"to":140,"value":13},{"from":141,"to":231,"value":13}],"color":[{"from":0,"to":8,"value":"#cc7832"},{"from":8,"to":9,"value":"#a9b7c6"},{"from":10,"to":12,"value":"#a9b7c6"},{"from":12,"to":23,"value":"#cc7832"},{"from":23,"to":36,"value":"#a9b7c6"},{"from":37,"to":39,"value":"#a9b7c6"},{"from":39,"to":56,"value":"#cc7832"},{"from":56,"to":58,"value":"#a9b7c6"},{"from":58,"to":62,"value":"#cc7832"},{"from":63,"to":98,"value":"#cc7832"},{"from":98,"to":100,"value":"#a9b7c6"},{"from":100,"to":105,"value":"#6897bb"},{"from":105,"to":140,"value":"#629755"},{"from":141,"to":143,"value":"#629755"},{"from":143,"to":179,"value":"#cc7832"},{"from":179,"to":181,"value":"#a9b7c6"},{"from":181,"to":184,"value":"#6897bb"},{"from":184,"to":231,"value":"#629755"}],"back-color":[{"from":0,"to":9,"value":"#2b2b2b"},{"from":10,"to":36,"value":"#2b2b2b"},{"from":37,"to":62,"value":"#2b2b2b"},{"from":63,"to":140,"value":"#2b2b2b"},{"from":141,"to":231,"value":"#2b2b2b"}]}}],"heights":[40],"widths":[620]}</content><styles/></table><para><coId>7115-1638854560623</coId><text>运行之后，若payment8001停止2s以上后，payment就会被从eureka中移除</text><inline-styles><font-size><from>0</from><to>45</to><value>16</value></font-size></inline-styles><styles/></para><para><coId>1839-1638854560657</coId><text/><inline-styles/><styles/></para><para><coId>8279-1638854560684</coId><text/><inline-styles/><styles/></para><para><coId>1070-1638854560719</coId><text/><inline-styles/><styles/></para><para><coId>3626-1638854560750</coId><text/><inline-styles/><styles/></para><para><coId>3185-1638854560781</coId><text/><inline-styles/><styles/></para><para><coId>1751-1638854560828</coId><text/><inline-styles/><styles/></para><para><coId>4468-1638854560860</coId><text/><inline-styles/><styles/></para><para><coId>1944-1638701670601</coId><text/><inline-styles/><styles/></para></body></note>