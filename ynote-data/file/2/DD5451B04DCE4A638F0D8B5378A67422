<?xml version="1.0" encoding="UTF-8" standalone="no"?><note xmlns="http://note.youdao.com" file-version="0" schema-version="1.0.3"><head><list id="2686-1618919159878" type="unordered"/><list id="8664-1618919159883" type="unordered"/></head><body><heading compat="true" level="2"><coId>5725-1618112326737</coId><text>1引导加载自动配置类</text><inline-styles><bold><from>0</from><to>10</to><value>true</value></bold><font-size><from>0</from><to>10</to><value>20</value></font-size></inline-styles><styles/></heading><heading compat="true" level="2"><coId>9264-1618115391311</coId><text>public @interface SpringBootApplication{}等同于：</text><inline-styles><bold><from>0</from><to>45</to><value>true</value></bold><font-size><from>0</from><to>45</to><value>20</value></font-size></inline-styles><styles/></heading><para><coId>5021-1618112943613</coId><text>@SpringBootConfiguration</text><inline-styles><font-size><from>0</from><to>24</to><value>16</value></font-size></inline-styles><styles><text-indent>1</text-indent></styles></para><para><coId>1137-1618112952265</coId><text>@EnableAutoConfiguration</text><inline-styles><font-size><from>0</from><to>24</to><value>16</value></font-size></inline-styles><styles><text-indent>1</text-indent></styles></para><para><coId>3046-1618112952265</coId><text>@ComponentScan(excludeFilters = { @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),@Filter(type=FilterType.CUSTOM,classes=AutoConfigurationExcludeFilter.class) })</text><inline-styles><font-size><from>0</from><to>182</to><value>16</value></font-size></inline-styles><styles><text-indent>1</text-indent></styles></para><para><coId>5869-1618112998642</coId><text/><inline-styles/><styles/></para><para><coId>3157-1618113014593</coId><text>1、@SpringBootConfiguration</text><inline-styles><font-size><from>0</from><to>26</to><value>16</value></font-size></inline-styles><styles/></para><para><coId>4427-1618113044653</coId><text>内含@Configuration  代表当前是一个配置类</text><inline-styles><font-size><from>0</from><to>28</to><value>16</value></font-size></inline-styles><styles/></para><para><coId>3940-1618113064133</coId><text>2、@ComponentScan</text><inline-styles><font-size><from>0</from><to>16</to><value>16</value></font-size></inline-styles><styles/></para><para><coId>9260-1618113127969</coId><text>指定扫描哪些，Spring注解；</text><inline-styles><font-size><from>0</from><to>16</to><value>16</value></font-size></inline-styles><styles/></para><para><coId>8894-1618113130623</coId><text>3、@EnableAutoConfiguration</text><inline-styles><font-size><from>0</from><to>26</to><value>16</value></font-size></inline-styles><styles/></para><para><coId>3110-1618113252434</coId><text>内含多个注解</text><inline-styles><font-size><from>0</from><to>6</to><value>16</value></font-size></inline-styles><styles/></para><code><coId>6971-1618113268090</coId><text>@AutoConfigurationPackage
@Import(AutoConfigurationImportSelector.class)
public @interface EnableAutoConfiguration {}
</text><inline-styles/><styles/><language>java</language><theme>tomorrow</theme></code><para><coId>6898-1618113268090</coId><text>①    @AutoConfigurationPackage</text><inline-styles><font-size><from>0</from><to>30</to><value>16</value></font-size></inline-styles><styles/></para><code><coId>7755-1618113543185</coId><text>@Import(AutoConfigurationPackages.Registrar.class)  
//给容器中导入一个组件
public @interface AutoConfigurationPackage {}
//利用Registrar给容器中导入一系列组件
//将指定的一个包下的所有组件导入进来？MainApplication 所在包下。
</text><inline-styles/><styles/><language>java</language><theme>tomorrow</theme></code><para><coId>9212-1618113543185</coId><text>②   @Import(AutoConfigurationImportSelector.class)</text><inline-styles><font-size><from>0</from><to>50</to><value>16</value></font-size></inline-styles><styles/></para><para><coId>9787-1618115172088</coId><text>@Import 高级用法： https://www.bilibili.com/video/BV1gW411W7wy?p=8</text><inline-styles><italic><from>0</from><to>61</to><value>true</value></italic><underline><from>14</from><to>61</to><value>true</value></underline><font-size><from>0</from><to>61</to><value>12</value></font-size><color><from>14</from><to>61</to><value>#003884</value></color><back-color><from>0</from><to>61</to><value>#FAE220</value></back-color><href><from>14</from><to>61</to><value>https://www.bilibili.com/video/BV1gW411W7wy?p=8</value></href></inline-styles><styles/></para><code><coId>8099-1618114147098</coId><text>1、利用getAutoConfigurationEntry(annotationMetadata);给容器中批量导入一些组件
2、调用List&lt;String&gt; configurations = getCandidateConfigurations(annotationMetadata, attributes)获取到所有需要导入到容器中的配置类
3、利用工厂加载 Map&lt;String, List&lt;String&gt;&gt; loadSpringFactories(@Nullable ClassLoader classLoader)；得到所有的组件
4、从META-INF/spring.factories位置来加载一个文件。
    默认扫描我们当前系统里面所有META-INF/spring.factories位置的文件
    spring-boot-autoconfigure-2.3.4.RELEASE.jar包里面也有META-INF/spring.factories
</text><inline-styles/><styles/><language>java</language><theme>tomorrow</theme></code><para><coId>2752-1618114111286</coId><text/><inline-styles/><styles/></para><para><coId>7189-1618115166528</coId><text>spring.factories中写死了springboot中所有的配置类</text><inline-styles/><styles/></para><para><coId>2638-1618115243693</coId><text>spring-boot-autoconfigure-2.3.4.RELEASE.jar/META-INF/spring.factories</text><inline-styles><font-size><from>0</from><to>69</to><value>16</value></font-size></inline-styles><styles/></para><para><coId>1795-1618115166702</coId><text/><inline-styles/><styles/></para><heading compat="true" level="2"><coId>4427-1618115268213</coId><text>2、按需开启自动配置项</text><inline-styles><bold><from>0</from><to>11</to><value>true</value></bold><font-size><from>0</from><to>11</to><value>20</value></font-size></inline-styles><styles/></heading><para><coId>2646-1618115363519</coId><text>虽然我们127个场景的所有自动配置启动的时候默认全部加载。xxxxAutoConfiguration</text><inline-styles><font-size><from>0</from><to>50</to><value>16</value></font-size></inline-styles><styles/></para><para><coId>4279-1618115357635</coId><text>按照条件装配规则（@Conditional），最终会按需配置。</text><inline-styles><font-size><from>0</from><to>31</to><value>16</value></font-size></inline-styles><styles/></para><heading compat="true" level="2"><coId>7521-1618115268715</coId><text>3、修改默认配置</text><inline-styles><bold><from>0</from><to>8</to><value>true</value></bold><font-size><from>0</from><to>8</to><value>20</value></font-size><color><from>0</from><to>8</to><value>#393939</value></color></inline-styles><styles/></heading><code><coId>2629-1618919013047</coId><text>        @Bean
        @ConditionalOnBean(MultipartResolver.class)  //容器中有这个类型组件
        @ConditionalOnMissingBean(name = DispatcherServlet.MULTIPART_RESOLVER_BEAN_NAME) 
        //容器中没有这个名字 multipartResolver 的组件
        public MultipartResolver multipartResolver(MultipartResolver resolver) {
            //给@Bean标注的方法传入了对象参数，这个参数的值就会从容器中找。
            //SpringMVC multipartResolver。防止有些用户配置的文件上传解析器不符合规范
            // Detect if the user has created a MultipartResolver but named it incorrectly
            return resolver;
        }
</text><inline-styles/><styles/><language>java</language><theme>tomorrow</theme></code><para><coId>4073-1618115268801</coId><text>SpringBoot默认会在底层配好所有的组件。但是如果用户自己配置了以用户的优先</text><inline-styles/><styles/></para><code><coId>3130-1618919029009</coId><text>@Bean
@ConditionalOnMissingBean
public CharacterEncodingFilter characterEncodingFilter() { }
</text><inline-styles/><styles/><language>java</language><theme>tomorrow</theme></code><para><coId>9742-1618115268814</coId><text/><inline-styles/><styles/></para><para><coId>1510-1618115269011</coId><text/><inline-styles/><styles/></para><para><coId>9360-1618115166871</coId><text>总结：</text><inline-styles><font-size><from>0</from><to>3</to><value>15</value></font-size><color><from>0</from><to>3</to><value>#404040</value></color></inline-styles><styles><line-height>1.74</line-height></styles></para><list-item level="1" list-id="2686-1618919159878"><coId>1610-1618919159889</coId><text>SpringBoot先加载所有的自动配置类  xxxxxAutoConfiguration</text><inline-styles><font-size><from>0</from><to>45</to><value>15</value></font-size><color><from>0</from><to>45</to><value>#404040</value></color></inline-styles><styles><line-height>1.74</line-height></styles></list-item><list-item level="1" list-id="2686-1618919159878"><coId>8978-1618919159889</coId><text>每个自动配置类按照条件进行生效，默认都会绑定配置文件指定的值。xxxxProperties里面拿。xxxProperties和配置文件进行了绑定</text><inline-styles><font-size><from>0</from><to>72</to><value>15</value></font-size><color><from>0</from><to>72</to><value>#404040</value></color></inline-styles><styles><line-height>1.74</line-height></styles></list-item><list-item level="1" list-id="2686-1618919159878"><coId>2130-1618919159889</coId><text>生效的配置类就会给容器中装配很多组件</text><inline-styles><font-size><from>0</from><to>18</to><value>15</value></font-size><color><from>0</from><to>18</to><value>#404040</value></color></inline-styles><styles><line-height>1.74</line-height></styles></list-item><list-item level="1" list-id="2686-1618919159878"><coId>2048-1618919159889</coId><text>只要容器中有这些组件，相当于这些功能就有了</text><inline-styles><font-size><from>0</from><to>21</to><value>15</value></font-size><color><from>0</from><to>21</to><value>#404040</value></color></inline-styles><styles><line-height>1.74</line-height></styles></list-item><list-item level="1" list-id="2686-1618919159878"><coId>1580-1618919159889</coId><text>定制化配置</text><inline-styles><font-size><from>0</from><to>5</to><value>15</value></font-size><color><from>0</from><to>5</to><value>#404040</value></color></inline-styles><styles><line-height>1.74</line-height></styles></list-item><list-item level="2" list-id="8664-1618919159883"><coId>9993-1618919159889</coId><text>用户直接自己@Bean替换底层的组件</text><inline-styles><font-size><from>0</from><to>18</to><value>15</value></font-size><color><from>0</from><to>18</to><value>#404040</value></color></inline-styles><styles><line-height>1.74</line-height></styles></list-item><list-item level="2" list-id="8664-1618919159883"><coId>3871-1618919159889</coId><text>用户去看这个组件是获取的配置文件什么值就去修改。</text><inline-styles><font-size><from>0</from><to>24</to><value>15</value></font-size><color><from>0</from><to>24</to><value>#404040</value></color></inline-styles><styles><line-height>1.74</line-height></styles></list-item><para><coId>7617-1618922775355</coId><text/><inline-styles/><styles><line-height>1.74</line-height></styles></para><para><coId>1517-1618922776701</coId><text>xxxxxAutoConfiguration ---&gt; 组件  ---&gt; xxxxProperties里面拿值  ----&gt; application.properties</text><inline-styles><bold><from>0</from><to>85</to><value>true</value></bold><color><from>0</from><to>85</to><value>#f5222d</value></color></inline-styles><styles><line-height>1.74</line-height></styles></para></body></note>