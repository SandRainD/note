{"2":"1","3":"Ju9C-1621846617594","4":{"version":1,"incompatibleVersion":0,"fv":"0"},"5":[{"3":"3060-1621846615933","5":[{"2":"2","3":"p5PQ-1621846617594","7":[{"8":"在实际开发中，我们经常会遇到这样的情况：有 2 个或者多个相互关联的表，如 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"商品信息 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"和 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"库存信息 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"分别存放在 2 个不同的数据表中，我们在添加一条新商品记录的时候，为了保证数据的完整性，必须同时在库存表中添加一条库存记录。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"3tAo-1658379833092","4":{"version":1},"5":[{"2":"2","3":"81Ta-1658379833091","7":[{"8":"这样一来，我们就必须把这两个关联的操作步骤写到程序里面，而且要用 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"事务 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"包裹起来，确保这两个操作成为一个 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"原子操作 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"，要么全部执行，要么全部不执行。要是遇到特殊情况，可能还需要对数据进行手动维护，这样就很 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"容易忘记其中的一步 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"，导致数据缺失。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"bQXP-1658379833099","4":{"version":1},"5":[{"2":"2","3":"gBnv-1658379833098","7":[{"8":"这个时候，咱们可以使用触发器。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"你可以创建一个触发器，让商品信息数据的插入操作自动触发库存数据的插入操作。","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"这样一来，就不用担心因为忘记添加库存数据而导致的数据缺失了。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"WrFK-1658379854817","4":{"l":"h3"},"5":[{"2":"2","3":"RVqm-1658379854815","7":[{"8":"触发器概述","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"xjbj-1658379855291","4":{"version":1},"5":[{"2":"2","3":"Oobl-1658379855288","7":[{"8":"MySQL从 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"5.0.2 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"版本开始支持触发器。MySQL的触发器和存储过程一样，都是嵌入到MySQL服务器的一段程序。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"ZfBo-1658396837739","4":{"version":1},"5":[{"2":"2","3":"7u7G-1658396837738","7":[{"8":"触发器是由 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"事件来触发 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"某个操作，这些事件包括 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"INSERT ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"、 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"UPDATE ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"、 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"DELETE ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"事件。所谓事件就是指用户的动作或者触发某项行为。如果定义了触发程序，当数据库执行这些语句时候，就相当于事件发生了，就会 ","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]},{"8":"自动 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"激发触发器执行相应的操作。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"JXLe-1658396837745","4":{"version":1},"5":[{"2":"2","3":"uUTf-1658396837744","7":[{"8":"当对数据表中的数据执行插入、更新和删除操作，需要自动执行一些数据库逻辑时，可以使用触发器来实现。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"6Sg9-1658380097623","4":{"l":"h1"},"5":[{"2":"2","3":"wfo1-1658380097620","7":[{"8":"触发器的创建","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"lidT-1658396863947","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"bkQD-1658396863946","5":[{"2":"2","3":"mXCW-1658380098315","7":[{"8":"CREATE TRIGGER 触发器名称 "}]}],"6":"cl"},{"3":"qkPx-1658396864680","4":{},"5":[{"2":"2","3":"0X5P-1658396864679","7":[{"8":"{BEFORE|AFTER} {INSERT|UPDATE|DELETE} ON 表名 "}]}],"6":"cl"},{"3":"fFCR-1658396864682","4":{},"5":[{"2":"2","3":"l8Vr-1658396864681","7":[{"8":"FOR EACH ROW "}]}],"6":"cl"},{"3":"OyIF-1658396864684","4":{},"5":[{"2":"2","3":"1rVi-1658396864683","7":[{"8":"触发器执行的语句块;"}]}],"6":"cl"}],"6":"cd"},{"3":"pUmq-1658380098503","4":{"li":"C56H-1658396874375","lt":"unordered","ll":1},"5":[{"2":"2","3":"oH5I-1658380098501","7":[{"8":"表名 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"：表示触发器监控的对象。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"3AWG-1658396869351","4":{"li":"C56H-1658396874375","lt":"unordered","ll":1},"5":[{"2":"2","3":"SVoN-1658396869350","7":[{"8":"BEFORE|AFTER ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"：表示触发的时间。BEFORE 表示在事件之前触发；AFTER 表示在事件之后触发。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"N1Bq-1658396869353","4":{"li":"C56H-1658396874375","lt":"unordered","ll":1},"5":[{"2":"2","3":"Uh83-1658396869352","7":[{"8":"INSERT|UPDATE|DELETE ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"}]},{"8":"：表示触发的事件。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"HpvE-1658396869355","4":{"li":"C56H-1658396874375","lt":"unordered","ll":2},"5":[{"2":"2","3":"C8ev-1658396869354","7":[{"8":"INSERT 表示插入记录时触发；","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"hY0i-1658396869357","4":{"li":"C56H-1658396874375","lt":"unordered","ll":2},"5":[{"2":"2","3":"r5ml-1658396869356","7":[{"8":"UPDATE 表示更新记录时触发；","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"uHXT-1658396869359","4":{"li":"C56H-1658396874375","lt":"unordered","ll":2},"5":[{"2":"2","3":"q4N6-1658396869358","7":[{"8":"DELETE 表示删除记录时触发","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"s7IK-1658380098708","4":{"li":"C56H-1658396874375","lt":"unordered","ll":1},"5":[{"2":"2","3":"xViM-1658380098705","7":[{"8":"触发器执行的语句块 ","9":[{"0":"#e96900","2":"c"},{"0":16,"2":"fs"},{"0":"NSimSun","2":"ff"}]},{"8":"：可以是单条SQL语句，也可以是由BEGIN…END结构组成的复合语句块。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}],"6":"l"},{"3":"StoD-1658380098917","4":{"l":"h1"},"5":[{"2":"2","3":"nOk3-1658380098915","7":[{"8":"查看、删除触发器","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"lY25-1658380099390","4":{"l":"h3"},"5":[{"2":"2","3":"Jpua-1658380099388","7":[{"8":"查看触发器","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"PLHW-1658396919942","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"jCoa-1658396919941","5":[{"2":"2","3":"TlPE-1658396915774","7":[{"8":"SHOW TRIGGERS\\G "}]}],"6":"cl"},{"3":"xpVg-1658396933116","5":[{"2":"2","3":"Nuub-1658396933114","7":[{"8":"SHOW CREATE TRIGGER 触发器名 "}]}],"6":"cl"},{"3":"X7mi-1658396936201","5":[{"2":"2","3":"35ZA-1658396936199","7":[{"8":"SELECT * FROM information_schema.TRIGGERS; "}]}],"6":"cl"}],"6":"cd"},{"3":"TIm6-1658380099619","4":{"l":"h3"},"5":[{"2":"2","3":"QuCm-1658380099617","7":[{"8":"删除触发器","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"4Ix2-1658396948499","4":{"wrap":false,"la":"","th":"default"},"5":[{"3":"qp8T-1658396948498","5":[{"2":"2","3":"odWt-1658380099848","7":[{"8":"DROP TRIGGER IF EXISTS 触发器名称;"}]}],"6":"cl"}],"6":"cd"},{"3":"W9Pe-1658380100042","4":{"l":"h1"},"5":[{"2":"2","3":"fwrK-1658380100039","7":[{"8":"触发器的优缺点","9":[{"2":"b"},{"0":"#34495e","2":"c"}]}]}],"6":"h"},{"3":"Xobc-1658380100442","4":{"version":1},"5":[{"2":"2","3":"8UnK-1658380100439","7":[{"8":"1","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"、触发器可以确保数据的完整性","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"a3Qz-1658396984400","4":{"version":1},"5":[{"2":"2","3":"uVFr-1658396984399","7":[{"8":"2","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"、触发器可以帮助我们记录操作日志。","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"qydO-1658396993281","4":{"version":1},"5":[{"2":"2","3":"J7yo-1658396993279","7":[{"8":"3","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"、触发器还可以用在操作数据前，对数据进行合法性检查","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"EY72-1658396996952","4":{"version":1},"5":[{"2":"2","3":"xyWy-1658396996951","7":[{"8":"缺点 ","9":[{"2":"b"},{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"tHxQ-1658397007202","4":{"version":1},"5":[{"2":"2","3":"Y03x-1658397007200","7":[{"8":"1","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"、触发器最大的一个问题就是可读性差。","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"fJQy-1658397014132","4":{"version":1},"5":[{"2":"2","3":"PN0H-1658397014130","7":[{"8":"2","9":[{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]},{"8":"、相关数据的变更，可能会导致触发器出错。","9":[{"2":"b"},{"0":"#880000","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"inqn-1658397022603","4":{"version":1},"5":[{"2":"2","3":"Syv7-1658397022601","7":[{"8":"注意点","9":[{"2":"b"},{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"YCtS-1658397026246","4":{"version":1},"5":[{"2":"2","3":"uXiV-1658397026245","7":[{"8":"注意，如果在子表中定义了外键约束，并且外键指定了ON UPDATE/DELETE CASCADE/SET NULL子句，此时修改父表被引用的键值或删除父表被引用的记录行时，也会引起子表的修改和删除操作，此时基于子表的UPDATE和DELETE语句定义的触发器并不会被激活。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]},{"3":"QX0o-1658397026548","4":{"version":1},"5":[{"2":"2","3":"xDgd-1658397026547","7":[{"8":"例如：基于子表员工表（t_employee）的DELETE语句定义了触发器t1，而子表的部门编号（did）字段定义了外键约束引用了父表部门表（t_department）的主键列部门编号（did），并且该外键加了“ON DELETE SET NULL”子句，那么如果此时删除父表部门表（t_department）在子表员工表（t_employee）有匹配记录的部门记录时，会引起子表员工表（t_employee）匹配记录的部门编号（did）修改为NULL， 但是此时不会激活触发器t1。只有直接对子表员工表（t_employee）执行DELETE语句时才会激活触发器t1。","9":[{"0":"#34495e","2":"c"},{"0":16,"2":"fs"}]}]}]}],"__compress__":true,"title":""}